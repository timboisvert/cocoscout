<% content_for :title, "Role Claimed!" %>

<div class="min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-md mx-auto">
    <!-- Success Icon -->
    <div class="flex items-center justify-center mb-6">
      <div class="flex items-center justify-center h-16 w-16 rounded-full bg-green-100">
        <svg class="h-8 w-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
        </svg>
      </div>
    </div>

    <div class="text-center mb-8">
      <h1 class="text-2xl font-bold text-gray-900 mb-2">You're In!</h1>
      <p class="text-gray-600">
        You've successfully claimed the role of <strong><%= @role.name %></strong>.
      </p>
    </div>

    <!-- Show Details -->
    <div class="bg-white shadow rounded-lg p-4 mb-6">
      <div class="flex items-center gap-4">
        <% poster_url = safe_poster_url(@show) %>
        <% if poster_url %>
          <%= image_tag poster_url,
              alt: @production.name,
              class: "w-16 h-24 object-cover rounded-lg" %>
        <% end %>
        <div>
          <h2 class="font-semibold text-gray-900"><%= @production.name %></h2>
          <% unless @show.linked? %>
            <p class="text-sm text-gray-600"><%= @show.date_and_time.strftime("%A, %B %d, %Y at %l:%M %p") %></p>
            <% if @show.location %>
              <p class="text-xs text-gray-500"><%= @show.location.name %></p>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>

    <div class="bg-pink-50 rounded-lg p-4 mb-6">
      <p class="text-sm text-pink-800">
        <strong>Your Role:</strong> <%= @role.name %>
      </p>
    </div>

    <% if @show.linked? %>
      <% linked_shows = @show.event_linkage.shows.order(:date_and_time).to_a %>
      <% if linked_shows.any? %>
        <div class="bg-white shadow rounded-lg overflow-hidden mb-6">
          <div class="p-4 border-b border-gray-200">
            <p class="text-sm font-medium text-gray-700">You're confirmed for all of these events</p>
          </div>

          <div class="divide-y divide-gray-100">
            <% linked_shows.each do |event_show| %>
              <% is_past = event_show.date_and_time < Time.current %>
              <div class="flex items-center gap-3 p-4 <%= 'opacity-50' if is_past %>">
                <div class="flex-shrink-0 w-5 h-5 rounded-full <%= is_past ? 'bg-gray-300' : 'bg-pink-500' %> flex items-center justify-center">
                  <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                  </svg>
                </div>
                <div class="flex-1">
                  <p class="text-sm font-medium <%= is_past ? 'text-gray-400' : 'text-gray-900' %>">
                    <%= event_show.date_and_time.strftime("%A, %B %d") %>
                    <span class="<%= is_past ? 'text-gray-400' : 'text-gray-500' %> font-normal"><%= event_show.time_range_display %></span>
                  </p>
                  <p class="text-xs <%= is_past ? 'text-gray-400' : 'text-gray-500' %>">
                    <%= event_show.display_name %>
                  </p>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    <% end %>

    <div class="bg-gray-50 rounded-lg p-4 text-sm text-gray-600 mb-6">
      We've added you to the cast. You may receive additional information from the production team.
    </div>

    <%= render "shared/button", text: "Done", path: my_dashboard_path, variant: "primary", size: "jumbo" %>
  </div>
</div>
