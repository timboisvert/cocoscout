<%
  # Button component for profile and groups pages
  #
  # Usage Examples:
  #   render "shared/button", text: "View Public Profile", variant: "primary", icon: "eye"
  #   render "shared/button", text: "Share Profile", variant: "outline", icon: "share"
  #   render "shared/button", text: "Add Social Media/Link", variant: "outline-pink", icon: "plus"
  #   render "shared/button", text: "Save Changes", variant: "primary", size: "medium"
  #   render "shared/button", text: "Cancel", variant: "ghost-cancel", size: "medium"
  #   render "shared/button", text: "Check Availability", variant: "primary"
  #   render "shared/button", path: root_path, text: "Go Home", variant: "primary"
  #
  # Parameters:
  #   text (required): Button text/label
  #   variant: Button style variant (see options below)
  #   size: "small", "medium" (default), "large"
  #   icon: Icon name (optional) - renders before text
  #   type: :submit (default), :button, :link
  #   path: URL path (for link_to rendering)
  #   target: Link target (e.g., "_blank")
  #   rel: Link rel attribute (e.g., "noopener")
  #   data: Hash of data attributes
  #   classes: Additional custom classes
  #   onclick: JavaScript onclick handler
  #
  # Variant Options:
  #   "primary" - Pink filled button (bg-pink-500 hover:bg-pink-600)
  #   "secondary" - Gray bordered button (border-gray-300 hover:bg-gray-50)
  #   "danger" - Red filled button (bg-red-600 hover:bg-red-700)
  #   "outline" - White with gray border (border-gray-300 hover:border-pink-500)
  #   "outline-pink" - White with pink border (border-pink-200 hover:border-pink-300)
  #   "ghost" - Text only, no border (text-gray-700 hover:bg-gray-100)
  #   "ghost-cancel" - Cancel text style (text-gray-700 hover:text-gray-900)

  text = local_assigns[:text] || ""
  variant = local_assigns[:variant] || "primary"
  size = local_assigns[:size] || "medium"
  type = local_assigns[:type] || :submit
  classes = local_assigns[:classes] || ""
  data = local_assigns[:data] || {}
  icon = local_assigns[:icon]
  path = local_assigns[:path]
  target = local_assigns[:target]
  rel = local_assigns[:rel]
  onclick = local_assigns[:onclick]
  style = local_assigns[:style]
  disabled = local_assigns[:disabled] || false

  # Base classes for all buttons
  base_classes = "inline-flex items-center justify-center gap-2 font-medium rounded transition-colors cursor-pointer whitespace-nowrap"

  # Variant-specific classes
  variant_classes = case variant
    when "primary"
      "bg-pink-500 hover:bg-pink-600 text-white"
    when "secondary"
      "bg-white border border-gray-300 hover:bg-gray-50 text-gray-700"
    when "danger"
      "bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 disabled:cursor-not-allowed"
    when "outline"
      "bg-white border-2 border-gray-300 hover:border-pink-500 hover:bg-pink-50 text-gray-700 hover:text-pink-600 transition-all"
    when "outline-pink"
      "bg-white hover:bg-pink-50 text-pink-600 border border-pink-200 hover:border-pink-300 transition-all"
    when "ghost"
      "text-gray-700 hover:bg-gray-100"
    when "ghost-cancel"
      "text-gray-700 hover:text-gray-900"
    else
      "bg-pink-500 hover:bg-pink-600 text-white"
  end

  # Size-specific padding and text size
  size_classes = case size
    when "small"
      "px-3 py-1.5 text-sm"
    when "medium"
      "px-3 py-1.5 text-sm sm:px-5 sm:py-2.5 sm:h-10"
    when "large"
      "px-6 py-2 text-sm sm:px-8 sm:py-3"
    when "jumbo"
      "w-full text-center px-4 py-3 font-semibold shadow-sm hover:shadow-md"
    else
      "px-3 py-1.5 text-sm sm:px-5 sm:py-2.5 sm:h-10"
  end

  # Icon size based on button size
  icon_size = case size
    when "small"
      "w-4 h-4"
    when "medium", "large"
      "w-5 h-5"
    when "jumbo"
      "w-6 h-6"
    else
      "w-5 h-5"
  end

  # Combine all classes
  all_classes = "#{base_classes} #{variant_classes} #{size_classes} #{classes}".strip

  # Icon SVG paths
  icons = {
    "eye" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>',
    "share" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186l9.566-5.314m-9.566 7.5l9.566 5.314m0 0a2.25 2.25 0 103.935 2.186 2.25 2.25 0 00-3.935-2.186zm0-12.814a2.25 2.25 0 103.933-2.185 2.25 2.25 0 00-3.933 2.185z" /></svg>',
    "plus" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>',
    "calendar" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z" /></svg>',
    "list" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" /></svg>',
    "search" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>',
    "clipboard" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184" /></svg>',
    "trash" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" /></svg>',
    "paper-airplane" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" /></svg>',
    "arrow-path" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" /></svg>',
    "pencil" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" /></svg>',
    "x-mark" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" /></svg>',
    "bars-3" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" /></svg>',
    "print" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z" /></svg>',
    "queue-list" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z" /></svg>',
    "cog" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /></svg>',
    "qr-code" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z" /></svg>',
    "download" => '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="ICON_SIZE"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>'
  }

  # Get icon HTML if specified
  icon_html = if icon && icons[icon]
    icons[icon].gsub("ICON_SIZE", icon_size).html_safe
  else
    nil
  end

  # Build data attributes string
  # Note: We use h() for most values but NOT for 'action' since Stimulus uses -> syntax
  data_attrs = data.map { |k, v|
    key = k.to_s.dasherize
    # Don't escape Stimulus action strings (they contain -> which would break)
    value = key == "action" ? v : ERB::Util.html_escape(v)
    "data-#{key}=\"#{value}\""
  }.join(' ')

  # HTTP method for links (default GET, can be :post, :patch, :delete, etc.)
  http_method = local_assigns[:method]
%>

<% if path.present? && http_method.present? %>
  <%= button_to path, method: http_method, class: all_classes, data: data do %>
    <%= icon_html if icon_html %>
    <span><%= text %></span>
  <% end %>
<% elsif path.present? %>
  <%= link_to path, class: all_classes, data: data, target: target, rel: rel, onclick: onclick do %>
    <%= icon_html if icon_html %>
    <span><%= text %></span>
  <% end %>
<% elsif type == :submit %>
  <button type="submit" class="<%= all_classes %>" <%= "style=\"#{style}\"".html_safe if style %> <%= data_attrs.html_safe if data.any? %> <%= "onclick=\"#{onclick}\"".html_safe if onclick %> <%= "disabled" if disabled %>>
    <%= icon_html if icon_html %>
    <span><%= text %></span>
  </button>
<% else %>
  <button type="<%= type %>" class="<%= all_classes %>" <%= "style=\"#{style}\"".html_safe if style %> <%= data_attrs.html_safe if data.any? %> <%= "onclick=\"#{onclick}\"".html_safe if onclick %> <%= "disabled" if disabled %>>
    <%= icon_html if icon_html %>
    <span><%= text %></span>
  </button>
<% end %>
