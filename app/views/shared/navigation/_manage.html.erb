
<nav class="hidden w-56 bg-white border-r border-r-2 border-gray-200 lg:flex flex-col transition-all duration-200 ease-in-out z-20 justify-between fixed left-0 top-0 h-screen">
  <div>

    <%= link_to manage_path, class: "mb-2" do %>
      <div class="p-5 pb-3 text-3xl coustard-regular bg-pink-500">
        <h1 class="text-white">CocoScout</h1>
      </div>
    <% end %>

    <% if session[:impersonate_user_id] %>
      <% impersonated = User.find_by(id: session[:impersonate_user_id]) %>
      <% if impersonated %>
        <div class="w-full bg-pink-200 p-4 text-left text-sm">
          <div>Impersonating:</div>
          <div class="font-bold truncate"><%= impersonated.email_address %></div>
          <div>
            <%= button_to "Stop Impersonating", stop_impersonating_user_path, method: :post, class: "mt-2 px-3 py-1 rounded-lg bg-pink-500 text-white font-bold hover:bg-pink-600 cursor-pointer text-left" %>
          </div>
        </div>
      <% end %>
    <% end %>

    <div class="">

      <% if Current.production.present? && !Current.production.new_record? %>

        <div class="flex h-14">
          <%= link_to manage_production_path(Current.production), class: "flex-1 flex items-center justify-left bg-pink-50 hover:bg-pink-100 font-medium text-md pl-4 h-full overflow-hidden whitespace-nowrap text-ellipsis" do %>
            <span class="overflow-hidden whitespace-nowrap text-ellipsis block w-full"><%= Current.production.name %></span>
          <% end %>
          <%= link_to manage_productions_path, class: "flex items-center justify-center px-2 h-full bg-pink-50 hover:bg-pink-100 flex-shrink-0" do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-pink-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          <% end %>
        </div>

        <div class="border-b-2 border-pink-500">
            <%
            links = [
              {"Shows & Events" => manage_production_shows_path(Current.production)},
              {"Availability" => manage_production_availability_index_path(Current.production)},
              {"Cast" => manage_production_casts_path(Current.production)},
              {"Roles" => manage_production_roles_path(Current.production)},
              {"Auditions" => manage_production_auditions_path(Current.production)}
            ]
            %>

            <% links.each do |item| %>
              <%= link_to item.keys.first, item.values.first, class: "block px-4 py-2 hover:bg-pink-100 hover:text-pink-700 transition-all text-sm" %>
            <% end %>
        </div>

      <% else %>
        <%= link_to "Productions", manage_productions_path, class: "flex items-center gap-3 px-4 py-2 hover:bg-pink-500 hover:text-white transition-all font-medium" %>
      <% end %>

      <%= link_to "Directory", manage_people_path, class: "flex items-center gap-3 px-4 py-2 hover:bg-pink-500 hover:text-white transition-all font-medium" %>
      <%= link_to "Production Team", manage_team_index_path, class: "flex items-center gap-3 px-4 py-2 hover:bg-pink-500 hover:text-white transition-all font-medium" %>
      <%= link_to "Locations", manage_locations_path, class: "flex items-center gap-3 px-4 py-2 hover:bg-pink-500 hover:text-white transition-all font-medium" %>
    </div>

    <% if Current.user.can_manage? %>
      <%= link_to "Exit Dashboard", my_dashboard_path, class: "block px-4 py-2 text-pink-400 text-xs underline" %>
    <% end %>


  </div>

  <!-- Bottom section -->
  <div>

    <div class="flex justify-center">
      <%= image_tag "cocoscout.png", alt: "CocoScout Logo", class: "w-32" %>
    </div>

    <div class="p-5 pb-4 border-t-4 border-pink-500 transition-all flex flex-col bg-pink-50">
      <% if Current.production_company.present? %>
        <div class="font-bold text-sm"><%= Current.production_company.name %></div>
        <div>
          <%= link_to "Switch", select_manage_production_companies_path, class: "text-pink-500 font-bold underline text-xs inline-block" %>

          <% if current_user_is_global_manager? %>
            <%= link_to "Edit", edit_manage_production_company_path(Current.production_company), class: "text-pink-500 font-bold underline text-xs inline-block" %>
          <% end %>
        </div>
      <% end  %>
    </div>

  </div>

</nav>