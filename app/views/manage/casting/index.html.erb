<% content_for :title, "Casting - #{@production.name}" %>

<div class="w-full" data-controller="linked-highlight">
  <%= render partial: "shared/notice", locals: { notice: notice } %>

  <%= render partial: "shared/top_menu", locals: {
    breadcrumbs: [
      ["Casting", manage_casting_path]
    ],
    text: @production.name,
    links: []
  } %>

  <div class="border-t border-gray-200 pt-4 mt-2">
    <%= render "shared/filters/filter_bar", filter_groups: [
      {
        label: "View",
        filters: [
          { text: "Upcoming", path: manage_casting_production_path(@production, filter: "upcoming"), active: @filter == "upcoming" },
          { text: "Past", path: manage_casting_production_path(@production, filter: "past"), active: @filter == "past" }
        ]
      }
    ] %>

    <!-- Show Cast Assignments Section -->
    <div>
      <% if @shows.any? %>
        <div class="space-y-1">
          <% @shows.each do |show| %>
            <%
              sign_up_regs = @sign_up_registrations_by_show[show.id] || []
            %>
            <%= render "manage/casting/cast_card", show: show, production: @production, title: nil, roles: @roles, roles_count: @roles_count, people_by_id: @people_by_id, groups_by_id: @groups_by_id, sign_up_registrations: sign_up_regs %>
          <% end %>
        </div>
      <% else %>
        <p class="text-gray-500 text-sm"><%= @filter == "past" ? "No past shows found." : "No upcoming shows scheduled." %></p>
      <% end %>
    </div>
  </div>
</div>
