<div class="w-full">
  <!-- Page Header -->
  <div class="mb-6">
    <h1 class="text-2xl font-bold text-gray-900 coustard-regular">Shoutouts</h1>
    <p class="text-gray-600 text-sm mt-1">See shoutouts you've received and given to others.</p>
  </div>

  <!-- Tabs -->
  <div class="border-b border-gray-200 mb-6">
    <nav class="-mb-px flex gap-6">
      <%= link_to "Received", my_shoutouts_path(tab: "received"),
          class: "pb-3 px-1 text-sm font-medium border-b-2 #{@active_tab == 'received' ? 'border-pink-500 text-pink-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}" %>
      <%= link_to "Given", my_shoutouts_path(tab: "given"),
          class: "pb-3 px-1 text-sm font-medium border-b-2 #{@active_tab == 'given' ? 'border-pink-500 text-pink-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}" %>
    </nav>
  </div>

  <% if @active_tab == "received" %>
    <!-- Received Shoutouts -->
    <div class="border border-gray-200 rounded-lg overflow-hidden">
      <div class="bg-gray-50 px-4 py-3 border-b border-gray-200">
        <h3 class="text-md font-semibold text-gray-900 coustard-regular">Shoutouts I've Received</h3>
      </div>
      <div class="p-4">
        <% if @received_shoutouts.any? %>
          <div class="space-y-4">
            <% @received_shoutouts.each do |shoutout| %>
              <div class="p-4 bg-white border border-gray-200 rounded-lg" data-controller="expand-shoutout">
                <div class="flex items-start gap-3">
                  <!-- Author headshot -->
                  <% headshot = shoutout.author.safe_headshot_variant(:thumb) %>
                  <% if headshot %>
                    <%= link_to public_profile_path(shoutout.author.public_key) do %>
                      <%= image_tag headshot, class: "w-10 h-10 rounded-full object-cover flex-shrink-0", alt: shoutout.author.name %>
                    <% end %>
                  <% else %>
                    <%= link_to public_profile_path(shoutout.author.public_key), class: "w-10 h-10 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0" do %>
                      <%= shoutout.author.initials %>
                    <% end %>
                  <% end %>

                  <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2 mb-1">
                      <%= link_to shoutout.author.name, public_profile_path(shoutout.author.public_key), class: "font-medium text-gray-900 hover:text-pink-600" %>
                      <span class="text-xs text-gray-500"><%= time_ago_in_words(shoutout.created_at) %> ago</span>
                    </div>

                    <!-- Shoutout content with expand/collapse -->
                    <div class="text-sm text-gray-700">
                      <div data-expand-shoutout-target="preview" class="whitespace-pre-wrap">
                        <%= shoutout.preview(length: 200) %>
                        <% if shoutout.content.length > 200 %>
                          <button data-action="click->expand-shoutout#expand" class="text-pink-600 hover:text-pink-700 font-medium ml-1">Read more</button>
                        <% end %>
                      </div>
                      <div data-expand-shoutout-target="full" class="hidden whitespace-pre-wrap">
                        <%= shoutout.content %>
                        <button data-action="click->expand-shoutout#collapse" class="text-pink-600 hover:text-pink-700 font-medium ml-1">Show less</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <div class="text-center py-8">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 mx-auto text-gray-300 mb-3">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z" />
            </svg>
            <p class="text-gray-500 text-sm">You haven't received any shoutouts yet.</p>
            <p class="text-gray-400 text-xs mt-1">Share your profile with others to start receiving shoutouts!</p>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <!-- Given Shoutouts -->
    <div class="border border-gray-200 rounded-lg overflow-hidden">
      <div class="bg-gray-50 px-4 py-3 border-b border-gray-200">
        <h3 class="text-md font-semibold text-gray-900 coustard-regular">Shoutouts I've Given</h3>
      </div>
      <div class="p-4">
        <% if @given_shoutouts.any? %>
          <div class="space-y-4">
            <% @given_shoutouts.each do |shoutout| %>
              <div class="p-4 bg-white border border-gray-200 rounded-lg" data-controller="expand-shoutout">
                <div class="flex items-start gap-3">
                  <!-- Recipient headshot -->
                  <% headshot = shoutout.shoutee.safe_headshot_variant(:thumb) %>
                  <% if headshot %>
                    <%= link_to public_profile_path(shoutout.shoutee.public_key) do %>
                      <%= image_tag headshot, class: "w-10 h-10 rounded-full object-cover flex-shrink-0", alt: shoutout.shoutee.name %>
                    <% end %>
                  <% else %>
                    <%= link_to public_profile_path(shoutout.shoutee.public_key), class: "w-10 h-10 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0" do %>
                      <%= shoutout.shoutee.initials %>
                    <% end %>
                  <% end %>

                  <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2 mb-1">
                      <span class="text-xs text-gray-500">To</span>
                      <%= link_to shoutout.shoutee.name, public_profile_path(shoutout.shoutee.public_key), class: "font-medium text-gray-900 hover:text-pink-600" %>
                      <span class="text-xs text-gray-500">â€¢ <%= time_ago_in_words(shoutout.created_at) %> ago</span>
                    </div>

                    <!-- Shoutout content with expand/collapse -->
                    <div class="text-sm text-gray-700">
                      <div data-expand-shoutout-target="preview" class="whitespace-pre-wrap">
                        <%= shoutout.preview(length: 200) %>
                        <% if shoutout.content.length > 200 %>
                          <button data-action="click->expand-shoutout#expand" class="text-pink-600 hover:text-pink-700 font-medium ml-1">Read more</button>
                        <% end %>
                      </div>
                      <div data-expand-shoutout-target="full" class="hidden whitespace-pre-wrap">
                        <%= shoutout.content %>
                        <button data-action="click->expand-shoutout#collapse" class="text-pink-600 hover:text-pink-700 font-medium ml-1">Show less</button>
                      </div>
                    </div>

                    <!-- Delete button -->
                    <div class="mt-2">
                      <%= button_to my_destroy_shoutout_path(shoutout), method: :delete,
                          class: "text-xs text-red-500 hover:text-red-700",
                          data: { confirm: "Are you sure you want to delete this shoutout?" } do %>
                        Delete
                      <% end %>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <div class="text-center py-8">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 mx-auto text-gray-300 mb-3">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z" />
            </svg>
            <p class="text-gray-500 text-sm">You haven't given any shoutouts yet.</p>
            <p class="text-gray-400 text-xs mt-1">Visit someone's profile to give them a shoutout!</p>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
