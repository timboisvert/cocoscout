<% content_for :title, @production.name %>

<div class="w-full mb-10">
  <%= render partial: "shared/notice", locals: { notice: notice } %>
  <%= render partial: "shared/top_menu", locals: {
    breadcrumbs: [],
    text: @production.name,
    links: [
      { text: "Edit", path: edit_manage_production_path(@production) }
    ]
  } %>

  <div class="w-full">
    <%= render partial: "shared/top_menu", locals: {
      breadcrumbs: [],
      text: "Description",
      links: []
    } %>
    <div class="mb-5">
      <% if @production.description.present? %>
        <%= @production.description %>
      <% else %>
        <span class="text-sm text-gray-500">
          You haven't added a description.
          <% if Current.user.manager? %>
            <%= link_to "Add a description", edit_manage_production_path(@production), class: "text-pink-500 underline" %>
          <% end %>
        </span>
      <% end %>
    </div>
  </div>

  <div class="w-full pt-4">
    <%= render partial: "shared/top_menu", locals: {
      breadcrumbs: [],
      text: "Contact Email",
      links: []
    } %>
    <div class="mb-5 text-nowrap">
      <% if @production.contact_email.present? %>
        <%= mail_to @production.contact_email, class: "font-medium rounded-lg text-xs px-3 py-1.5 sm:text-sm sm:px-5 sm:h-10 sm:py-2.5 text-center mb-0 inline-block text-white bg-pink-500 hover:bg-pink-600 flex items-center gap-2" do %>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-18 8V8a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
          </svg>
          <span><%= @production.contact_email %></span>
        <% end %>
      <% else %>
        <span class="text-sm text-gray-500">
          No contact email provided.
          <% if Current.user.manager? %>
            <%= link_to "Add a contact email", edit_manage_production_path(@production), class: "text-pink-500 underline" %>
          <% end %>
        </span>
      <% end %>
    </div>
  </div>

  <div class="w-full pt-4">
    <%= render partial: "shared/top_menu", locals: {
      breadcrumbs: [],
      text: "Logo",
      links: []
    } %>

    <% if @production.logo.attached? %>
      <%= image_tag @production.logo.variant(:small), class: "h-auto" %>

      <% if Current.user.manager? %>
        <div>
          <%= link_to "Replace logo", edit_manage_production_path(@production), class: "text-pink-500 underline text-sm" %>
        </div>
      <% end %>
    <% else %>
      <span class="text-sm text-gray-500">
        No logo added.

        <% if Current.user.manager? %>
          <%= link_to "Upload a logo", edit_manage_production_path(@production), class: "text-pink-500 underline" %>
        <% end %>
      </span>
    <% end %>
  </div>

  <div class="w-full pt-4">

    <%= render partial: "shared/top_menu", locals: {
      breadcrumbs: [],
      text: "Production/Season Posters",
      links: [
        { text: "Add a Poster", path: new_manage_production_poster_path(@production) }
      ]
    } %>

    <% if @production.posters.any? %>
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 w-full">
        <% @production.posters.each do |poster| %>
          <div class="bg-white rounded shadow p-4 flex flex-col">
            <% if poster.image.attached? %>
              <%= image_tag poster.image.variant(:small), class: "w-full h-auto object-cover mb-2" %>
            <% end %>
            <span class="font-semibold"><%= poster.name.presence || "Untitled Poster" %></span>

            <% if Current.user.manager? %>
              <div class="flex gap-2 mt-2">
                <%= link_to "Edit", edit_manage_production_poster_path(@production, poster), class: "text-sm underline text-pink-500 hover:text-pink-600" %>
                <%= link_to "Delete",
                      manage_production_poster_path(@production, poster),
                      data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this poster?" },
                      class: "text-sm underline text-pink-500 hover:text-pink-600" %>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="text-gray-500 text-sm mt-2">
        No posters added.
        <% if Current.user.manager? %>
          <%= link_to "Add a poster", new_manage_production_poster_path(@production), class: "text-pink-500 underline" %>
        <% end %>
      </div>
    <% end %>

  </div>


</div>
