<div class="space-y-4">
  <% if @questions.any? %>
    <div class="space-y-2" data-controller="question-order" data-question-order-url="<%= reorder_questions_manage_production_audition_cycle_path(@production, @audition_cycle) %>">
      <% @questions.each do |question| %>
        <div class="p-4 border border-gray-200 bg-white rounded-lg hover:border-gray-400 transition-all cursor-move relative group" draggable="true" data-question-order-target="item" data-id="<%= question.id %>" data-action="dragstart->question-order#startDrag dragend->question-order#endDrag dragover->question-order#dragOver drop->question-order#drop touchstart->question-order#touchStart touchmove->question-order#touchMove touchend->question-order#touchEnd" onclick="event.stopPropagation();">
          <div class="flex items-start gap-4">
            <span class="text-gray-400 cursor-move mt-1" title="Drag to reorder">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5" />
              </svg>
            </span>
            <div class="flex-1">
              <p class="mb-1 font-bold">
                <%= question.text %>
              </p>
              <p class="text-sm text-gray-500 mb-1">
                Type: <%= question.question_type_class&.label || question.question_type %>
                <% if question.question_type_class&.needs_options? && question.question_options.any? %>
                <span class="ml-1 text-gray-500">(Options: <%= question.question_options.pluck(:text).join(", ") %>)</span>
                <% end %>
              </p>
              <p class="text-sm text-gray-500">
                Required: <%= question.required ? "Yes" : "No" %>
              </p>
            </div>
          </div>

          <!-- Hover buttons on the right -->
          <div class="absolute right-3 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col gap-2">
            <button
              type="button"
              data-action="question-modal#openForEdit"
              data-question-text="<%= question.text %>"
              data-question-type="<%= question.question_type %>"
              data-question-required="<%= question.required %>"
              data-update-path="<%= update_question_manage_production_audition_cycle_path(@production, @audition_cycle, question_id: question.id) %>"
              class="cursor-pointer">
              <%= render "shared/button", text: "Edit", variant: "primary", size: "small", type: :button %>
            </button>
            <%= button_to destroy_question_manage_production_audition_cycle_path(@production, @audition_cycle, question_id: question.id),
                method: :delete,
                form: { data: { turbo_confirm: "Are you sure you want to delete this question?" }, class: "inline" },
                class: "cursor-pointer" do %>
              <%= render "shared/button", text: "Delete", variant: "primary", size: "small", type: :submit %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="p-4 text-sm border border-gray-200 bg-white rounded-lg text-center text-gray-500">
      No custom questions yet. Click "Add Question" to create your first question.
    </div>
  <% end %>

  <div class="mt-4">
    <%= render "shared/button",
      text: "Add Question",
      variant: "primary",
      size: "medium",
      type: :button,
      icon: "plus",
      data: { action: "question-modal#openForNew" } %>
  </div>
</div>