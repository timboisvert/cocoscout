<% content_for :title, "Seating Configurations" %>

<%= render partial: "shared/top_menu", locals: {
  breadcrumbs: [
    ["Ticketing", manage_ticketing_index_path]
  ],
  text: "Seating Configurations",
  links: [
    { text: "Add Configuration", path: manage_new_seating_configuration_path }
  ]
} %>

<div class="w-full">
  <%= render partial: "shared/notice", locals: { notice: notice, alert: alert } %>

  <% if @configurations.any? %>
    <%
      # Sort spaces: named spaces first (alphabetically), then nil (Other) last
      sorted_spaces = @configurations_by_space.keys.sort_by { |space| space ? [0, space.name.downcase] : [1, ""] }
    %>
    <% sorted_spaces.each do |space| %>
      <div class="mb-8">
        <h2 class="text-lg font-medium text-gray-900 mb-4"><%= space&.name || "Other" %></h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <% @configurations_by_space[space].each do |config| %>
            <%= link_to manage_seating_configuration_path(config), class: "block bg-white rounded-lg border border-gray-200 p-4 hover:border-gray-300 hover:shadow-sm transition-all" do %>
              <div class="flex items-start justify-between mb-3">
                <h3 class="font-medium text-gray-900"><%= config.name %></h3>
                <span class="text-sm text-gray-500"><%= config.total_capacity %> seats</span>
              </div>

              <% if config.description.present? %>
                <p class="text-sm text-gray-500 line-clamp-2"><%= config.description %></p>
              <% end %>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  <% else %>
    <div class="bg-gray-50 rounded-lg border border-dashed border-gray-300 p-8 text-center">
      <p class="text-gray-600 mb-4">No seating configurations yet. Create one to define your venue layout.</p>
      <%= link_to manage_new_seating_configuration_path do %>
        <%= render "shared/button", text: "Add Configuration", variant: "primary", size: "medium" %>
      <% end %>
    </div>
  <% end %>
</div>
