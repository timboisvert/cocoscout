<% content_for :title, "Schedule an Audition Session" %>

<div class="w-full">
  <%= render partial: "shared/notice", locals: { notice: notice } %>
  <%= render partial: "shared/top_menu", locals: {
    breadcrumbs: [
      ["Productions", productions_path],
      [@production.name, production_path(@production)]
    ],
    text: "Audition Sessions",
    links: [
      {
        text: "Manage Audition Sessions",
        path: production_audition_sessions_path(@production)
      }
    ]
  } %>

  <% if @audition.nil? %>

  <% else %>

    <div id="<%= dom_id @audition_session %>" class="w-full sm:w-auto my-5 space-y-5 mb-30">
      <div class="flex flex-col sm:flex-row w-full gap-6">
        <div class="w-full sm:w-[60%] h-screen bg-gray-100">
          <% if @person.resume.attached? %>
            <embed src="<%= url_for(@person.resume) %>" type="application/pdf" width="100%" height="100%" />
          <% end %>
        </div>
        <div class="w-full sm:w-[40%] flex flex-col">

          <%= render "shared/person_card", person: @person, show_delete: false %>

          <% if @answers.any? %>
            <% @answers.each do |answer| %>
              <div class="p-2 border border-gray-200 rounded-lg hover:border-gray-400 transition-all mt-2">
                <div class="text-md"><%= answer.question.text %></div>
                <div class="text-md font-medium">
                  <% if answer.question.question_type == "yesno" %>
                    <%= answer.value.capitalize %>
                  <% elsif answer.question.question_type == "multiple-multiple" %>
                    <% answer.value_as_array.each do |value| %>
                      <div class="inline-block mb-1 px-2 bg-pink-100 rounded-lg"><%= value %></div>
                    <% end %>
                  <% elsif answer.question.question_type == "multiple-single" %>
                    <div class="inline-block mb-1 px-2 bg-pink-100 rounded-lg"><%= answer.value %></div>
                  <% else %>
                    <%= answer.value %>
                  <% end %>
                </div>
              </div>
            <% end %>
          <% end %>

          <div>
            <%= link_to "Edit this Audition Request",
              edit_production_call_to_audition_audition_request_path(@production, @call_to_audition, @audition_request),
              class: "mt-6 bg-pink-500 hover:bg-pink-600 text-white py-2 px-4 rounded transition-colors cursor-pointer inline-block" %>

            <%= link_to "Delete this Audition Request",
              production_call_to_audition_audition_request_path(@production, @call_to_audition, @audition_request),
              data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this audition request?" },
              class: "mt-6 bg-pink-500 hover:bg-pink-600 text-white py-2 px-4 rounded transition-colors cursor-pointer inline-block" %>
          </div>

      </div>
    </div>

  <% end %>

</div>

<div class="fixed bottom-0 left-0 h-21 w-full bg-white text-pink-500 p-2 border-t-4 border-pink-400 pl-56">

   <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 2xl:grid-cols-6 gap-1 w-full">
    <% @audition_session.auditions.each do |audition| %>
      <div class="flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:border-gray-400 transition-all relative group" data-audition-id="<%= audition.id %>">
          <% if audition.person.headshot.present? %>
              <%= image_tag audition.person.headshot.variant(:thumb), alt: audition.person.stage_name, class: "w-10 h-10 rounded-lg object-cover mb-1" %>
          <% end %>
          <span class="font-medium text-xs text-center"><%= audition.person.stage_name.truncate(20, omission: '...') %></span>
      </div>
    <% end %>
  </div>


</div>