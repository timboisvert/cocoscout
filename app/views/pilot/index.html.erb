<div class="min-h-screen bg-white" data-controller="pilot-setup"
  data-pilot-setup-talent-state-value="<%= @talent_state.to_json %>"
  data-pilot-setup-producer-state-value="<%= @producer_state.to_json %>">
  <!-- Header -->
  <div class="flex flex-col items-center pt-6 sm:pt-10 pb-4">
    <%= render "shared/cocoscout_logo", size: :medium %>
    <h1 class="mt-3 text-3xl sm:text-4xl coustard-regular text-pink-500">CocoScout</h1>
    <p class="mt-2 text-gray-600 text-sm">Pilot User Setup</p>
  </div>

  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
    <!-- Tabs Container -->
    <div data-controller="tabs" class="bg-white rounded-lg shadow-lg border border-gray-200">
      <!-- Tab Navigation -->
      <div class="border-b border-gray-200">
        <nav class="flex -mb-px" aria-label="Tabs">
          <button data-tabs-target="tab" data-index="0" data-action="click->tabs#select" class="cursor-pointer border-transparent text-gray-500 bg-gray-50 hover:text-gray-700 hover:border-gray-300 w-1/2 py-4 px-1 text-center border-b-2 font-medium text-sm">
            Pilot Producer/Theater Setup
          </button>
          <button data-tabs-target="tab" data-index="1" data-action="click->tabs#select" class="cursor-pointer border-transparent text-gray-500 bg-gray-50 hover:text-gray-700 hover:border-gray-300 w-1/2 py-4 px-1 text-center border-b-2 font-medium text-sm">
            Pilot Talent Setup
          </button>
        </nav>
      </div>

      <!-- Tab Panels -->
      <div class="p-6 sm:p-8">
        <!-- Producer Tab Panel (now first) -->
        <div data-tabs-target="panel" class="hidden">
          <div class="mb-6 flex items-center justify-between">
            <div>
              <h2 class="text-xl font-semibold text-gray-900 mb-2">Set Up Pilot Producer/Theater</h2>
              <p class="text-gray-600 text-sm">Create a complete theater setup with a step-by-step process.</p>
            </div>
            <%= button_to "Start Over", pilot_reset_producer_path, method: :delete,
              class: "cursor-pointer text-sm text-gray-600 hover:text-gray-900 underline",
              data: { turbo_confirm: "Are you sure? This will clear all progress." } %>
          </div>

          <!-- Producer Setup Steps -->
          <div class="space-y-4">
            <!-- Step 1: User -->
            <div class="border border-gray-200 rounded-lg p-4" data-pilot-setup-target="producerUserCard">
              <div class="flex items-center justify-between gap-4">
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-2 mb-1">
                    <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 text-gray-700 text-xs font-semibold flex-shrink-0">1</span>
                    <h3 class="font-semibold text-gray-900">Primary User</h3>
                  </div>
                  <div class="ml-8">
                    <p class="text-sm text-gray-600" data-pilot-setup-target="producerUserInfo">Click "Create User" to start</p>
                    <a href="#" class="hidden text-xs text-pink-600 hover:text-pink-700 underline mt-1"
                       data-pilot-setup-target="producerUserResendLink"
                       data-action="click->pilot-setup#resendProducerUserInvitation">
                      Resend Invitation Email
                    </a>
                  </div>
                </div>
                <div class="flex-shrink-0">
                  <button type="button"
                    data-action="click->pilot-setup#openProducerUserModal"
                    data-pilot-setup-target="producerUserButton"
                    class="inline-flex items-center justify-center gap-2 font-medium rounded transition-colors cursor-pointer whitespace-nowrap bg-pink-500 hover:bg-pink-600 text-white px-3 py-1.5 text-sm">
                    <span>Create User</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- Step 2: Organization -->
            <div class="border border-gray-200 rounded-lg p-4 opacity-50" data-pilot-setup-target="producerOrgCard">
              <div class="flex items-center justify-between gap-4">
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-2 mb-1">
                    <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 text-gray-700 text-xs font-semibold flex-shrink-0">2</span>
                    <h3 class="font-semibold text-gray-900">Organization/Theater</h3>
                  </div>
                  <p class="text-sm text-gray-600 ml-8" data-pilot-setup-target="producerOrgInfo">Complete step 1 first</p>
                </div>
                <div class="flex-shrink-0">
                  <button type="button"
                    data-action="click->pilot-setup#openProducerOrgModal"
                    data-pilot-setup-target="producerOrgButton"
                    class="inline-flex items-center justify-center gap-2 font-medium rounded transition-colors cursor-pointer whitespace-nowrap bg-pink-500 hover:bg-pink-600 text-white px-3 py-1.5 text-sm">
                    <span>Create Organization</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- Step 3: Location -->
            <div class="border border-gray-200 rounded-lg p-4 opacity-50" data-pilot-setup-target="producerLocationCard">
              <div class="flex items-center justify-between gap-4">
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-2 mb-1">
                    <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 text-gray-700 text-xs font-semibold flex-shrink-0">3</span>
                    <h3 class="font-semibold text-gray-900">Location/Venue</h3>
                  </div>
                  <p class="text-sm text-gray-600 ml-8" data-pilot-setup-target="producerLocationInfo">Complete step 2 first</p>
                </div>
                <div class="flex-shrink-0">
                  <button type="button"
                    data-action="click->pilot-setup#openProducerLocationModal"
                    data-pilot-setup-target="producerLocationButton"
                    class="inline-flex items-center justify-center gap-2 font-medium rounded transition-colors cursor-pointer whitespace-nowrap bg-pink-500 hover:bg-pink-600 text-white px-3 py-1.5 text-sm">
                    <span>Create Location</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- Step 4: Production -->
            <div class="border border-gray-200 rounded-lg p-4 opacity-50" data-pilot-setup-target="producerProductionCard">
              <div class="flex items-center justify-between gap-4">
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-2 mb-1">
                    <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 text-gray-700 text-xs font-semibold flex-shrink-0">4</span>
                    <h3 class="font-semibold text-gray-900">First Production</h3>
                  </div>
                  <p class="text-sm text-gray-600 ml-8" data-pilot-setup-target="producerProductionInfo">Complete step 3 first</p>
                </div>
                <div class="flex-shrink-0">
                  <button type="button"
                    data-action="click->pilot-setup#openProducerProductionModal"
                    data-pilot-setup-target="producerProductionButton"
                    class="inline-flex items-center justify-center gap-2 font-medium rounded transition-colors cursor-pointer whitespace-nowrap bg-pink-500 hover:bg-pink-600 text-white px-3 py-1.5 text-sm">
                    <span>Create Production</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- Step 5: Additional Producers/Co-Producers -->
            <div class="border border-gray-200 rounded-lg p-4 opacity-50" data-pilot-setup-target="producerAdditionalCard">
              <div class="flex items-center justify-between gap-4">
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-2 mb-1">
                    <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 text-gray-700 text-xs font-semibold flex-shrink-0">5</span>
                    <h3 class="font-semibold text-gray-900">Additional Collaborators <span class="text-xs text-gray-500 font-normal">(optional)</span></h3>
                  </div>
                  <p class="text-sm text-gray-600 ml-8" data-pilot-setup-target="producerAdditionalInfo">Complete step 4 first</p>
                </div>
                <div class="flex-shrink-0">
                  <button type="button"
                    data-action="click->pilot-setup#openProducerAdditionalModal"
                    data-pilot-setup-target="producerAdditionalButton"
                    class="inline-flex items-center justify-center gap-2 font-medium rounded transition-colors cursor-pointer whitespace-nowrap bg-pink-500 hover:bg-pink-600 text-white px-3 py-1.5 text-sm">
                    <span>Add Collaborator</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- Success Message -->
            <div data-pilot-setup-target="producerSuccess" class="hidden bg-green-50 border border-green-200 rounded-lg p-4">
              <div class="flex items-start gap-3">
                <svg class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <div class="flex-1">
                  <h4 class="font-semibold text-green-900">Producer/Theater Setup Complete!</h4>
                  <p class="text-sm text-green-800 mt-1">All core components have been created successfully.</p>
                  <button type="button"
                    data-action="click->pilot-setup#openCompleteSetupModal"
                    class="mt-3 inline-flex items-center justify-center gap-2 font-medium rounded transition-colors cursor-pointer whitespace-nowrap bg-green-600 hover:bg-green-700 text-white px-4 py-2 text-sm">
                    <span>Complete Setup</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Talent Tab Panel (now second) -->
        <div data-tabs-target="panel" class="hidden">
          <div class="mb-6 flex items-center justify-between">
            <div>
              <h2 class="text-xl font-semibold text-gray-900 mb-2">Set Up Pilot Talent</h2>
              <p class="text-gray-600 text-sm">Create a new talent user with a person profile. They will not be associated with any organization.</p>
            </div>
            <%= button_to "Start Over", pilot_reset_talent_path, method: :delete,
              class: "cursor-pointer text-sm text-gray-600 hover:text-gray-900 underline",
              data: { turbo_confirm: "Are you sure? This will clear all progress." } %>
          </div>

          <!-- Talent Setup Steps -->
          <div class="space-y-4">
            <!-- Step 1: User -->
            <div class="border border-gray-200 rounded-lg p-4" data-pilot-setup-target="talentUserCard">
              <div class="flex items-center justify-between gap-4">
                <div class="flex-1 min-w-0">
                  <h3 class="font-semibold text-gray-900">User Account</h3>
                  <p class="text-sm text-gray-600 mt-1" data-pilot-setup-target="talentUserInfo">Click "Create User" to set up the user account</p>
                </div>
                <div class="flex-shrink-0">
                  <button type="button"
                    data-action="click->pilot-setup#openTalentUserModal"
                    data-pilot-setup-target="talentUserButton"
                    class="inline-flex items-center justify-center gap-2 font-medium rounded transition-colors cursor-pointer whitespace-nowrap bg-pink-500 hover:bg-pink-600 text-white px-3 py-1.5 text-sm">
                    <span>Create User</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- Success Message -->
            <div data-pilot-setup-target="talentSuccess" class="hidden bg-green-50 border border-green-200 rounded-lg p-4">
              <div class="flex items-start gap-3">
                <svg class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <div class="flex-1">
                  <h4 class="font-semibold text-green-900">Talent Created Successfully!</h4>
                  <p class="text-sm text-green-800 mt-1" data-pilot-setup-target="talentSuccessMessage"></p>
                  <button type="button"
                    data-action="click->pilot-setup#confirmCompleteTalentSetup"
                    class="mt-3 inline-flex items-center justify-center gap-2 font-medium rounded transition-colors cursor-pointer whitespace-nowrap bg-green-600 hover:bg-green-700 text-white px-4 py-2 text-sm">
                    <span>Confirm & Reset</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<!-- Talent User Modal -->
<div data-pilot-setup-target="talentUserModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" data-action="click->pilot-setup#closeTalentUserModal">
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6" data-action="click->pilot-setup#stopPropagation">
    <h3 class="text-xl font-semibold text-gray-900 mb-4">Create Talent User</h3>

    <form data-pilot-setup-target="talentUserForm" data-action="submit->pilot-setup#submitTalentUser">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
          <input type="email" name="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Stage Name</label>
          <input type="text" name="name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <p class="text-xs text-gray-500 bg-blue-50 border border-blue-200 rounded-lg p-3">
          <strong>Note:</strong> An invitation email will be sent if the user doesn't already have a CocoScout account. The user will set their password when they accept the invitation. Talent users can be invited to organizations later.
        </p>

        <div data-pilot-setup-target="talentUserErrors" class="hidden bg-red-50 border border-red-200 rounded-lg p-3">
          <p class="text-sm text-red-800"></p>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-3">
        <%= render "shared/button",
          text: "Cancel",
          variant: "secondary",
          size: "medium",
          type: :button,
          data: { action: "click->pilot-setup#closeTalentUserModal" } %>
        <%= render "shared/button",
          text: "Create User",
          variant: "primary",
          size: "medium",
          type: :submit %>
      </div>
    </form>
  </div>
</div>

<!-- Producer User Modal -->
<div data-pilot-setup-target="producerUserModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" data-action="click->pilot-setup#closeProducerUserModal">
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6" data-action="click->pilot-setup#stopPropagation">
    <h3 class="text-xl font-semibold text-gray-900 mb-4">Create User</h3>

    <form data-pilot-setup-target="producerUserForm" data-action="submit->pilot-setup#submitProducerUser">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
          <input type="email" name="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Name</label>
          <input type="text" name="name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <p class="text-xs text-gray-500 bg-blue-50 border border-blue-200 rounded-lg p-3">
          <strong>Note:</strong> An invitation email will be sent if the user doesn't already have a CocoScout account. The user will set their password when they accept the invitation. Talent users can be invited to organizations later.
        </p>

        <div data-pilot-setup-target="producerUserErrors" class="hidden bg-red-50 border border-red-200 rounded-lg p-3">
          <p class="text-sm text-red-800"></p>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-3">
        <%= render "shared/button",
          text: "Cancel",
          variant: "secondary",
          size: "medium",
          type: :button,
          data: { action: "click->pilot-setup#closeProducerUserModal" } %>
        <%= render "shared/button",
          text: "Create User",
          variant: "primary",
          size: "medium",
          type: :submit %>
      </div>
    </form>
  </div>
</div>

<!-- Producer Organization Modal -->
<div data-pilot-setup-target="producerOrgModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" data-action="click->pilot-setup#closeProducerOrgModal">
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6" data-action="click->pilot-setup#stopPropagation">
    <h3 class="text-xl font-semibold text-gray-900 mb-4">Create Organization/Theater</h3>

    <form data-pilot-setup-target="producerOrgForm" data-action="submit->pilot-setup#submitProducerOrg">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Organization Name</label>
          <input type="text" name="organization_name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div data-pilot-setup-target="producerOrgErrors" class="hidden bg-red-50 border border-red-200 rounded-lg p-3">
          <p class="text-sm text-red-800"></p>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-3">
        <%= render "shared/button",
          text: "Cancel",
          variant: "secondary",
          size: "medium",
          type: :button,
          data: { action: "click->pilot-setup#closeProducerOrgModal" } %>
        <%= render "shared/button",
          text: "Create Organization",
          variant: "primary",
          size: "medium",
          type: :submit %>
      </div>
    </form>
  </div>
</div>

<!-- Producer Location Modal -->
<div data-pilot-setup-target="producerLocationModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" data-action="click->pilot-setup#closeProducerLocationModal">
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6" data-action="click->pilot-setup#stopPropagation">
    <h3 class="text-xl font-semibold text-gray-900 mb-4">Create Location/Venue</h3>

    <form data-pilot-setup-target="producerLocationForm" data-action="submit->pilot-setup#submitProducerLocation">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Name</label>
          <input type="text" name="location_name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Street Address Line 1</label>
          <input type="text" name="address1" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Street Address Line 2 <span class="text-gray-500 font-normal">(optional)</span></label>
          <input type="text" name="address2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">City</label>
          <input type="text" name="city" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">State/Province</label>
            <select name="state" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
              <option value="">Select State/Province</option>
              <option value="AL">Alabama</option>
              <option value="AK">Alaska</option>
              <option value="AZ">Arizona</option>
              <option value="AR">Arkansas</option>
              <option value="CA">California</option>
              <option value="CO">Colorado</option>
              <option value="CT">Connecticut</option>
              <option value="DE">Delaware</option>
              <option value="DC">District of Columbia</option>
              <option value="FL">Florida</option>
              <option value="GA">Georgia</option>
              <option value="HI">Hawaii</option>
              <option value="ID">Idaho</option>
              <option value="IL">Illinois</option>
              <option value="IN">Indiana</option>
              <option value="IA">Iowa</option>
              <option value="KS">Kansas</option>
              <option value="KY">Kentucky</option>
              <option value="LA">Louisiana</option>
              <option value="ME">Maine</option>
              <option value="MD">Maryland</option>
              <option value="MA">Massachusetts</option>
              <option value="MI">Michigan</option>
              <option value="MN">Minnesota</option>
              <option value="MS">Mississippi</option>
              <option value="MO">Missouri</option>
              <option value="MT">Montana</option>
              <option value="NE">Nebraska</option>
              <option value="NV">Nevada</option>
              <option value="NH">New Hampshire</option>
              <option value="NJ">New Jersey</option>
              <option value="NM">New Mexico</option>
              <option value="NY">New York</option>
              <option value="NC">North Carolina</option>
              <option value="ND">North Dakota</option>
              <option value="OH">Ohio</option>
              <option value="OK">Oklahoma</option>
              <option value="OR">Oregon</option>
              <option value="PA">Pennsylvania</option>
              <option value="RI">Rhode Island</option>
              <option value="SC">South Carolina</option>
              <option value="SD">South Dakota</option>
              <option value="TN">Tennessee</option>
              <option value="TX">Texas</option>
              <option value="UT">Utah</option>
              <option value="VT">Vermont</option>
              <option value="VA">Virginia</option>
              <option value="WA">Washington</option>
              <option value="WV">West Virginia</option>
              <option value="WI">Wisconsin</option>
              <option value="WY">Wyoming</option>
              <option value="">--- Canadian Provinces ---</option>
              <option value="AB">Alberta</option>
              <option value="BC">British Columbia</option>
              <option value="MB">Manitoba</option>
              <option value="NB">New Brunswick</option>
              <option value="NL">Newfoundland and Labrador</option>
              <option value="NT">Northwest Territories</option>
              <option value="NS">Nova Scotia</option>
              <option value="NU">Nunavut</option>
              <option value="ON">Ontario</option>
              <option value="PE">Prince Edward Island</option>
              <option value="QC">Quebec</option>
              <option value="SK">Saskatchewan</option>
              <option value="YT">Yukon</option>
            </select>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Zip/Postal Code</label>
            <input type="text" name="postal_code" required maxlength="10" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
          </div>
        </div>

        <div data-pilot-setup-target="producerLocationErrors" class="hidden bg-red-50 border border-red-200 rounded-lg p-3">
          <p class="text-sm text-red-800"></p>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-3">
        <%= render "shared/button",
          text: "Cancel",
          variant: "secondary",
          size: "medium",
          type: :button,
          data: { action: "click->pilot-setup#closeProducerLocationModal" } %>
        <%= render "shared/button",
          text: "Create Location",
          variant: "primary",
          size: "medium",
          type: :submit %>
      </div>
    </form>
  </div>
</div>

<!-- Producer Production Modal -->
<div data-pilot-setup-target="producerProductionModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" data-action="click->pilot-setup#closeProducerProductionModal">
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6" data-action="click->pilot-setup#stopPropagation">
    <h3 class="text-xl font-semibold text-gray-900 mb-4">Create First Production</h3>

    <form data-pilot-setup-target="producerProductionForm" data-action="submit->pilot-setup#submitProducerProduction">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Production Name</label>
          <input type="text" name="production_name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div data-pilot-setup-target="producerProductionErrors" class="hidden bg-red-50 border border-red-200 rounded-lg p-3">
          <p class="text-sm text-red-800"></p>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-3">
        <%= render "shared/button",
          text: "Cancel",
          variant: "secondary",
          size: "medium",
          type: :button,
          data: { action: "click->pilot-setup#closeProducerProductionModal" } %>
        <%= render "shared/button",
          text: "Create Production",
          variant: "primary",
          size: "medium",
          type: :submit %>
      </div>
    </form>
  </div>
</div>

<!-- Producer Show Modal -->
<div data-pilot-setup-target="producerShowModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" data-action="click->pilot-setup#closeProducerShowModal">
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6" data-action="click->pilot-setup#stopPropagation">
    <h3 class="text-xl font-semibold text-gray-900 mb-4">Create First Show/Event</h3>

    <form data-pilot-setup-target="producerShowForm" data-action="submit->pilot-setup#submitProducerShow">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Show Name</label>
          <input type="text" name="show_name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Date & Time</label>
          <input type="datetime-local" name="show_date_time" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div data-pilot-setup-target="producerShowErrors" class="hidden bg-red-50 border border-red-200 rounded-lg p-3">
          <p class="text-sm text-red-800"></p>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-3">
        <%= render "shared/button",
          text: "Cancel",
          variant: "secondary",
          size: "medium",
          type: :button,
          data: { action: "click->pilot-setup#closeProducerShowModal" } %>
        <%= render "shared/button",
          text: "Create Show",
          variant: "primary",
          size: "medium",
          type: :submit %>
      </div>
    </form>
  </div>
</div>

<!-- Producer Additional Producer Modal -->
<div data-pilot-setup-target="producerAdditionalModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" data-action="click->pilot-setup#closeProducerAdditionalModal">
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6" data-action="click->pilot-setup#stopPropagation">
    <h3 class="text-xl font-semibold text-gray-900 mb-4">Add Additional Collaborator</h3>

    <form data-pilot-setup-target="producerAdditionalForm" data-action="submit->pilot-setup#submitProducerAdditional">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
          <input type="email" name="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
            <input type="text" name="first_name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
            <input type="text" name="last_name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
          </div>
        </div>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
          <p class="text-sm text-blue-800">
            <strong>Note:</strong> This person will be added with organization-wide manager permissions. You can adjust their permissions after setup is complete.
          </p>
        </div>

        <div data-pilot-setup-target="producerAdditionalErrors" class="hidden bg-red-50 border border-red-200 rounded-lg p-3">
          <p class="text-sm text-red-800"></p>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-3">
        <%= render "shared/button",
          text: "Cancel",
          variant: "secondary",
          size: "medium",
          type: :button,
          data: { action: "click->pilot-setup#closeProducerAdditionalModal" } %>
        <%= render "shared/button",
          text: "Add Producer",
          variant: "primary",
          size: "medium",
          type: :submit %>
      </div>
    </form>
  </div>
</div>

<!-- Complete Setup Confirmation Modal -->
<div data-pilot-setup-target="completeSetupModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" data-action="click->pilot-setup#closeCompleteSetupModal">
  <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full p-6" data-action="click->pilot-setup#stopPropagation">
    <h3 class="text-xl font-semibold text-gray-900 mb-4">Complete Setup Summary</h3>

    <div class="space-y-4 mb-6">
      <p class="text-gray-700">Review everything that has been created during this setup:</p>

      <div class="bg-slate-50 rounded-lg p-4 space-y-3">
        <!-- User Created -->
        <div class="flex items-start gap-3">
          <svg class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <div class="flex-1">
            <p class="font-medium text-gray-900">Producer User Created</p>
            <p class="text-sm text-gray-600" data-pilot-setup-target="completeSetupUser"></p>
            <p class="text-xs text-gray-500 mt-1">Invitation email sent with password setup link</p>
          </div>
        </div>

        <!-- Organization Created -->
        <div class="flex items-start gap-3">
          <svg class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <div class="flex-1">
            <p class="font-medium text-gray-900">Organization Created</p>
            <p class="text-sm text-gray-600" data-pilot-setup-target="completeSetupOrg"></p>
            <p class="text-xs text-gray-500 mt-1">User set as organization owner</p>
          </div>
        </div>

        <!-- Location Created -->
        <div class="flex items-start gap-3">
          <svg class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <div class="flex-1">
            <p class="font-medium text-gray-900">Location Created</p>
            <p class="text-sm text-gray-600" data-pilot-setup-target="completeSetupLocation"></p>
          </div>
        </div>

        <!-- Production Created -->
        <div class="flex items-start gap-3">
          <svg class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <div class="flex-1">
            <p class="font-medium text-gray-900">Production Created</p>
            <p class="text-sm text-gray-600" data-pilot-setup-target="completeSetupProduction"></p>
          </div>
        </div>

        <!-- Additional Producers (if any) -->
        <div class="flex items-start gap-3" data-pilot-setup-target="completeSetupAdditionalSection">
          <svg class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <div class="flex-1">
            <p class="font-medium text-gray-900">Additional Collaborators Added</p>
            <p class="text-sm text-gray-600" data-pilot-setup-target="completeSetupAdditional"></p>
            <p class="text-xs text-gray-500 mt-1">Invitation emails sent</p>
          </div>
        </div>
      </div>

      <p class="text-sm text-gray-600">
        <strong>What happens next:</strong> This setup will be reset and you can create another pilot user setup.
        The created resources will remain in the system and the user can log in with the credentials sent via email.
      </p>
    </div>

    <div class="flex justify-end gap-3">
      <%= render "shared/button",
        text: "Cancel",
        variant: "secondary",
        size: "medium",
        type: :button,
        data: { action: "click->pilot-setup#closeCompleteSetupModal" } %>
      <%= render "shared/button",
        text: "Confirm & Reset Form",
        variant: "primary",
        size: "medium",
        type: :button,
        data: { action: "click->pilot-setup#confirmCompleteSetup" } %>
    </div>
  </div>
</div>
      </div>
    </form>
  </div>
</div>

</div>
<!-- End of pilot-setup controller scope -->