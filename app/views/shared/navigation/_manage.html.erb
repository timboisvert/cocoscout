
<nav class="hidden w-56 bg-white border-r border-r-2 border-gray-200 lg:flex flex-col transition-all duration-200 ease-in-out z-20 justify-between fixed left-0 top-16 h-[calc(100vh-4rem)]">
  <div class="flex-1 overflow-y-auto">

    <div class="mt-2">

      <% if Current.production.present? && !Current.production.new_record? %>

        <%
        # Check if user has production team access (not just reviewer access)
        has_team_access = Current.user.role_for_production(Current.production).present?

        # Build links based on access level
        links = []

        if has_team_access
          # Full navigation for production team members
          links = [
            {
              label: "Home",
              path: manage_path(Current.production),
              active: controller_name == "productions"
            },
            {
              label: "Shows & Events",
              path: manage_production_shows_path(Current.production),
              active: ["shows", "vacancies"].include?(controller_name)
            },
            {
              label: "Casting",
              path: manage_production_casting_path(Current.production),
              active: ["casting", "casting_availability", "roles", "talent_pools"].include?(controller_name)
            },
            {
              label: "Auditions",
              path: manage_production_auditions_path(Current.production),
              active: ["auditions", "audition_cycles", "audition_requests", "audition_sessions"].include?(controller_name)
            },
            {
              label: "Sign-ups",
              path: manage_production_sign_up_forms_path(Current.production),
              active: controller_name == "sign_up_forms"
            },
            {
              label: "Questionnaires",
              path: manage_production_questionnaires_path(Current.production),
              active: controller_name == "questionnaires"
            },
            {
              label: "Communications",
              path: manage_production_communications_path(Current.production),
              active: controller_name == "communications"
            },
            {
              label: "Money",
              path: manage_production_money_index_path(Current.production),
              active: controller_name == "payouts" || controller_name == "payout_schemes" || controller_name == "show_payouts" || controller_name == "show_financials"
            },
            {
              label: "Directory",
              path: manage_directory_path,
              active: ["directory", "people", "groups"].include?(controller_name)
            }
          ]
        else
          # Limited navigation for reviewer-only users
          links = [
            {
              label: "Auditions",
              path: manage_production_auditions_path(Current.production),
              active: ["auditions", "audition_cycles", "audition_requests", "audition_sessions"].include?(controller_name)
            }
          ]
        end
        %>

        <% links.each do |item| %>
          <%= render "shared/nav_link", text: item[:label], path: item[:path], active: item[:active], badge: item[:badge] %>
        <% end %>

      <% end %>

    </div>

  </div>

  <!-- Bottom section -->
  <div class="flex justify-center pb-0">
    <%= render "shared/cocoscout_logo", size: :large %>
  </div>

</nav>