<%# Renders the list of people in a cast, for AJAX refresh %>
  <div class="flex flex-wrap gap-2 w-full">
    <% if cast.people.any? %>
      <% cast.people.each do |cast_member| %>

        <%= link_to manage_person_path(cast_member) do %>
          <div class="flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:border-gray-400 transition-all relative group w-[120px]">
            <% headshot_variant = cast_member.safe_headshot_variant(:thumb) %>
            <% if headshot_variant %>
                <%= image_tag headshot_variant, alt: cast_member.name, class: "w-12 h-12 rounded-lg object-cover mb-1" %>
            <% else %>
                <div class="w-12 h-12 rounded-lg bg-gray-300 flex items-center justify-center mb-1 text-white font-bold">
                <%= cast_member.initials %>
                </div>
            <% end %>
            <span class="font-medium text-xs text-center"><%= cast_member.name.truncate(20, omission: '...') %></span>

            <% if current_user_can_manage?(cast.production) %>
              <button type="button"
                  class="absolute bottom-2 left-2 right-2 z-20 text-pink-500 bg-white rounded-md px-2 py-1 text-xs font-bold shadow hover:bg-pink-100 transition-all border border-pink-200 opacity-0 group-hover:opacity-100 cursor-pointer"
                  data-action="cast-person#remove"
                  data-person-id="<%= cast_member.id %>"
              >
                  Remove
              </button>
            <% end %>
          </div>
        <% end %>

      <% end %>
    <% end %>

    <% if current_user_can_manage?(cast.production) %>
      <div class="flex flex-col items-center p-3 bg-gray-50 border border-dashed border-gray-200 rounded-lg justify-center cursor-pointer hover:border-pink-500 transition-all relative group w-[120px]"
          data-cast-id="<%= cast.id %>"
          onclick="this.classList.add('hidden'); document.getElementById('cast-members-list-add-person-<%= cast.id %>').classList.remove('hidden')">
          <div class="w-12 h-12 rounded-lg bg-gray-50 flex items-center justify-center mb-1 text-pink-500 font-bold text-xl">
              +
          </div>
          <span class="font-medium text-xs text-center text-gray-500">Add a person</span>
      </div>
    <% end %>

  </div>