<% content_for :title, "Shows" %>

<div class="w-full mb-10">
  <%= render partial: "shared/notice", locals: { notice: notice } %>
  <%= render partial: "shared/top_menu", locals: {
    breadcrumbs: [],
    text: "Shows",
    links: []
  } %>

  <div class="grid grid-cols-1 gap-1">
    <% @production.shows.order(:date_and_time).each do |show| %>
      <div class="p-4 border border-gray-200 rounded-lg hover:border-gray-400 transition-all">

        <div class="flex items-top">
          <div class="w-1/3" >
            <p class="font-bold text-lg"><%= show.date_and_time.strftime("%A, %B %-d, %Y") %></p>
            <p class="font-bold text-lg"><%= show.date_and_time.strftime("%l:%M %p") %></p>
            <% if show.secondary_name.present? %>
              <p class="text-sm text-gray-500"><%= show.secondary_name %></p>
            <% end %>
            <div class="flex flex-col space-y-1">
              <%= link_to "Edit Cast", production_show_path(@production, show), class: "text-xs text-pink-500 underline" %>
            </div>

          </div>
          <div class="w-2/3 flex">
            <% show.show_person_role_assignments.each do |assignment| %>
                <%= link_to assignment.person do %>
                <div class="flex flex-col mr-1 items-center transition-all relative"
                  data-controller="tooltip"
                  data-tooltip-text="<%= assignment.person.name.truncate(40, omission: "...") %> - <%= assignment.role.name %>">
                  <% if assignment.person.headshot.present? %>
                  <%= image_tag assignment.person.headshot.variant(:thumb), alt: assignment.person.name, class: "w-15 h-15 rounded-lg object-cover", draggable: false %>
                  <% else %>
                  <div class="w-15 h-15 rounded-lg bg-gray-100 flex items-center justify-center text-black font-bold">
                    <%= assignment.person.initials %>
                  </div>
                  <% end %>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>

      </div>
    <% end %>


    <div class="mt-2">
      <%= render partial: "shared/link_button", locals: {text: "+ Schedule a Show", path: new_production_show_path(@production)} %>
    </div>
  </div>
</div>
