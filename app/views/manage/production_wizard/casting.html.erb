<%= render layout: "manage/production_wizard/wizard_layout", locals: { current_step: 3, step_name: "Casting" } do %>
  <div class="text-center mb-6">
    <div class="w-16 h-16 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-4">
      <svg class="w-8 h-8 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" />
      </svg>
    </div>
    <h2 class="text-xl font-bold text-gray-900 coustard-regular">How do you cast your shows?</h2>
    <p class="text-gray-600 mt-2">This sets how you'll assign performers to your events. You can always change this later.</p>
  </div>

  <%= form_with url: manage_productions_wizard_save_casting_path, method: :post, local: true, id: "casting-form" do |form| %>
    <div class="space-y-4">
      <!-- Talent Pool option -->
      <label class="block cursor-pointer">
        <div id="talent-pool-option" class="p-4 rounded-lg border-2 transition-colors <%= @wizard_state[:casting_source] == 'talent_pool' || @wizard_state[:casting_source].nil? ? 'border-pink-500 bg-pink-50' : 'border-gray-200 bg-gray-50' %> hover:border-pink-300">
          <div class="flex items-start">
            <input type="radio" name="casting_source" value="talent_pool"
                   <%= "checked" if @wizard_state[:casting_source] == 'talent_pool' || @wizard_state[:casting_source].nil? %>
                   class="mt-1 h-4 w-4 text-pink-500 border-gray-300 focus:ring-pink-500 accent-pink-500">
            <div class="ml-3">
              <p class="font-medium text-gray-900">Talent Pool</p>
              <p class="text-sm text-gray-500 mt-1">
                Build a pool of performers and cast them into shows.
                <span class="text-gray-600 font-medium">Best for:</span> theater companies, dance troupes, improv groups.
              </p>
            </div>
          </div>
        </div>
      </label>

      <!-- Manual option -->
      <label class="block cursor-pointer">
        <div id="manual-option" class="p-4 rounded-lg border-2 transition-colors <%= @wizard_state[:casting_source] == 'manual' ? 'border-pink-500 bg-pink-50' : 'border-gray-200 bg-gray-50' %> hover:border-pink-300">
          <div class="flex items-start">
            <input type="radio" name="casting_source" value="manual"
                   <%= "checked" if @wizard_state[:casting_source] == 'manual' %>
                   class="mt-1 h-4 w-4 text-pink-500 border-gray-300 focus:ring-pink-500 accent-pink-500">
            <div class="ml-3">
              <p class="font-medium text-gray-900">Manual Entry</p>
              <p class="text-sm text-gray-500 mt-1">
                Add performers by name or email as needed.
                <span class="text-gray-600 font-medium">Best for:</span> guest artists, one-off events, collaborations.
              </p>
            </div>
          </div>
        </div>
      </label>
    </div>

    <div class="mt-8 flex justify-between items-center">
      <%= link_to manage_productions_wizard_logo_path, class: "text-gray-500 hover:text-gray-700 text-sm py-2" do %>
        ‚Üê Back
      <% end %>
      <%= render "shared/button", text: "Next", variant: "primary", size: "medium", type: :submit %>
    </div>
  <% end %>
<% end %>

<script>
(function() {
  const talentPoolOption = document.getElementById('talent-pool-option');
  const manualOption = document.getElementById('manual-option');

  document.querySelectorAll('input[name="casting_source"]').forEach(radio => {
    radio.addEventListener('change', function() {
      if (this.value === 'talent_pool') {
        talentPoolOption.classList.add('border-pink-500', 'bg-pink-50');
        talentPoolOption.classList.remove('border-gray-200', 'bg-gray-50');
        manualOption.classList.remove('border-pink-500', 'bg-pink-50');
        manualOption.classList.add('border-gray-200', 'bg-gray-50');
      } else {
        manualOption.classList.add('border-pink-500', 'bg-pink-50');
        manualOption.classList.remove('border-gray-200', 'bg-gray-50');
        talentPoolOption.classList.remove('border-pink-500', 'bg-pink-50');
        talentPoolOption.classList.add('border-gray-200', 'bg-gray-50');
      }
    });
  });
})();
</script>
