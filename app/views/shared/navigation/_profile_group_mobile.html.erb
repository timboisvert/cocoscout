<!-- Mobile Navigation Overlay -->
<div class="lg:hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-40 hidden" data-mobile-nav-target="overlay" data-action="click->mobile-nav#close"></div>

<!-- Mobile Navigation Sidebar -->
<nav class="lg:hidden fixed left-0 top-16 h-[calc(100vh-4rem)] w-64 bg-white border-r-2 border-gray-200 transform -translate-x-full transition-transform duration-300 ease-in-out z-40 overflow-y-auto" data-mobile-nav-target="sidebar" data-controller="mobile-nav">
  <div class="px-4 py-4 border-b border-gray-200">
    <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Edit Group Profile</h3>
  </div>

  <div class="mt-2">
    <%
      sections = [
        { name: "Basic Info", id: "basic-info" },
        { name: "Social Media", id: "social-media" },
        { name: "Headshots", id: "headshots" },
        { name: "Videos & Reels", id: "videos" },
        { name: "Performance History", id: "performance-history" },
        { name: "Resumes", id: "resumes" },
        { name: "Members", id: "members" },
        { name: "Notifications", id: "notifications" }
      ]
    %>

    <% sections.each do |section| %>
      <a href="#<%= section[:id] %>"
         data-action="click->mobile-nav#close"
         class="mobile-profile-nav-link flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-pink-500 hover:text-white transition-all font-medium">
        <%= section[:name] %>
      </a>
    <% end %>
  </div>

  <!-- My Profile Section -->
  <div class="mt-6 px-4 py-4 border-t border-gray-200">
    <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">My Profile</h3>
    <div class="flex items-center gap-3 mb-3">
      <% if Current.user.person.headshot&.attached? %>
        <%= image_tag Current.user.person.headshot.variant(:thumb), class: "w-10 h-10 rounded-lg object-cover" %>
      <% else %>
        <div class="w-10 h-10 rounded-lg bg-pink-100 flex items-center justify-center text-pink-600 font-bold text-sm">
          <%= Current.user.person.initials %>
        </div>
      <% end %>
      <div class="flex-1 min-w-0">
        <p class="text-sm font-medium text-gray-900 truncate"><%= Current.user.person.name %></p>
      </div>
    </div>
    <%= link_to profile_path, class: "flex items-center justify-center gap-2 px-3 py-2 bg-gray-100 hover:bg-pink-50 text-gray-700 hover:text-pink-600 rounded-lg text-sm font-medium transition-all w-full" do %>
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
      </svg>
      <span>Edit My Profile</span>
    <% end %>
  </div>

  <div class="flex justify-center py-4">
    <%= render "shared/cocoscout_logo", size: :large %>
  </div>
</nav>

<script>
  // Smooth scroll to sections with offset for fixed header on mobile
  document.addEventListener('DOMContentLoaded', function() {
    const navLinks = document.querySelectorAll('.mobile-profile-nav-link');

    navLinks.forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const target = document.getElementById(targetId);

        if (target) {
          setTimeout(() => {
            const headerOffset = 80;
            const elementPosition = target.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

            window.scrollTo({
              top: offsetPosition,
              behavior: 'smooth'
            });
          }, 300);

          // Update active state
          navLinks.forEach(l => l.classList.remove('bg-pink-500', 'text-white'));
          this.classList.add('bg-pink-500', 'text-white');
        }
      });
    });
  });
</script>
