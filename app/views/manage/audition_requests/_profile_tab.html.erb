<%# Profile tab content for audition request show page %>
<%# Shows profile info without headshot (moved to Headshots tab) and without email (in hero) %>

<% if person.nil? %>
  <div class="p-6 text-center text-gray-500">
    <p>This person is no longer available.</p>
  </div>
<% else %>
  <div class="">
    <div class="flex flex-col lg:flex-row items-start lg:space-x-6">
      <div class="flex-1 w-full">
        <%# Socials Box (email is in hero now) %>
        <div class="border border-gray-200 rounded-lg overflow-hidden mb-4">
          <div class="bg-gray-50 px-4 py-3 border-b border-gray-200">
            <h3 class="text-md font-semibold text-gray-900 coustard-regular">Socials</h3>
          </div>
          <div class="p-4">
            <% if person.socials.any? %>
              <div class="space-y-1">
                <% person.socials.each do |social| %>
                  <div class="flex items-center space-x-2">
                    <%= social.icon(20) %>
                    <%= link_to social.handle, social.url, class: "text-pink-500 text-sm hover:underline", target: "_blank", rel: "noopener" %>
                  </div>
                <% end %>
              </div>
            <% else %>
              <p class="text-sm text-gray-500">No socials added</p>
            <% end %>
          </div>
        </div>

        <% if current_user_can_manage? || Current.user&.superadmin? %>
          <%# Organization Box %>
          <div class="border border-gray-200 rounded-lg overflow-hidden mb-4">
            <div class="bg-gray-50 px-4 py-3 border-b border-gray-200">
              <h3 class="text-md font-semibold text-gray-900 coustard-regular">Organization</h3>
            </div>
            <div class="p-4">
              <% if current_user_can_manage? && person.organizations.include?(Current.organization) %>
                <%= link_to "Remove from #{Current.organization.name}",
                    remove_from_organization_manage_person_path(person),
                    data: {
                      turbo_method: :post,
                      turbo_confirm: "Are you sure you want to remove #{person.name} from #{Current.organization.name}?"
                    },
                    class: "text-sm text-pink-500 hover:underline"
                %>
              <% end %>

              <% if @audition_request.present? %>
                <%= link_to "Delete Sign-up",
                    manage_production_audition_cycle_audition_request_path(@production, @audition_cycle, @audition_request),
                    data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this sign-up?" },
                    class: "block text-sm text-pink-500 hover:underline mt-1"
                %>
              <% end %>
            </div>
          </div>
        <% end %>

        <% if Current.user&.superadmin? %>
          <%# Superadmin Actions Box %>
          <div class="border border-gray-200 rounded-lg overflow-hidden mb-4">
            <div class="bg-gray-50 px-4 py-3 border-b border-gray-200">
              <h3 class="text-md font-semibold text-gray-900 coustard-regular">Superadmin Actions</h3>
            </div>
            <div class="p-4 space-y-2">
              <% if person.user %>
                <%= button_to impersonate_user_path, method: :post, params: { email: person.user.email_address }, class: "text-sm text-pink-500 hover:underline cursor-pointer" do %>
                  Impersonate
                <% end %>
              <% end %>
            </div>
          </div>
        <% end %>

      </div>
    </div>
  </div>
<% end %>
