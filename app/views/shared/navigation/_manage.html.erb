
<nav class="hidden w-56 bg-white border-r border-r-2 border-gray-200 lg:flex flex-col transition-all duration-200 ease-in-out z-20 justify-between fixed left-0 top-16 h-[calc(100vh-4rem)]">
  <div class="flex-1 overflow-y-auto">

    <div class="mt-2">

      <% if Current.organization.present? %>

        <%
        # Check if user has team access to any production
        has_team_access = Current.user.accessible_productions.where(organization: Current.organization).any? { |p| Current.user.role_for_production(p).present? }

        # Build links based on access level
        links = []

        if has_team_access
          # Full navigation for production team members
          links = [
            {
              label: "Home",
              path: manage_path,
              active: controller_name == "manage" && action_name == "index"
            },
            {
              label: "Shows & Events",
              path: manage_shows_path,
              active: ["shows", "org_shows", "vacancies", "show_wizard"].include?(controller_name)
            },
            {
              label: "Casting",
              path: manage_casting_path,
              active: ["casting", "org_casting", "casting_availability", "roles", "talent_pools", "casting_tables", "org_roles", "org_talent_pools", "org_availability"].include?(controller_name)
            },
            {
              label: "Sign-ups",
              path: manage_signups_path,
              active: ["signups", "org_signups", "sign_up_forms", "auditions", "audition_cycles", "audition_requests", "audition_sessions", "sign_up_form_wizard", "audition_cycle_wizard", "org_auditions", "org_forms"].include?(controller_name)
            },
            {
              label: "Communications",
              path: manage_communications_path,
              active: ["communications", "org_communications", "questionnaires", "org_questionnaires"].include?(controller_name)
            },
            {
              label: "Money",
              path: manage_money_index_path,
              active: controller_name == "money" || controller_name == "money_financials" || controller_name == "money_payouts" || controller_name == "show_payouts" || controller_name == "show_financials"
            },
            {
              label: "Ticketing",
              path: manage_ticketing_index_path,
              active: controller_name == "ticketing" || controller_name == "ticketing_providers" || controller_name == "ticketing_provider_wizard" || controller_name == "ticketing_productions" || controller_name == "ticketing_production_links" || controller_name == "ticketing_pending_events"
            },
            {
              label: "Directory",
              path: manage_directory_path,
              active: ["directory", "people", "groups"].include?(controller_name)
            }
          ]
        else
          # Limited navigation for reviewer-only users
          links = [
            {
              label: "Sign-ups",
              path: manage_signups_path,
              active: ["signups", "org_signups", "sign_up_forms", "auditions", "audition_cycles", "audition_requests", "audition_sessions"].include?(controller_name)
            }
          ]
        end
        %>

        <% links.each do |item| %>
          <%= render "shared/nav_link", text: item[:label], path: item[:path], active: item[:active], badge: item[:badge] %>
        <% end %>

      <% end %>

    </div>

  </div>

  <!-- Bottom section -->
  <div class="flex justify-center pb-0">
    <%= render "shared/cocoscout_logo", size: :large %>
  </div>

</nav>