<% audition_session ||= AuditionSession.new %>
<% form_url = audition_session.persisted? ? manage_update_signups_auditions_cycle_session_path(@production, @audition_cycle, audition_session) : manage_create_signups_auditions_cycle_session_path(@production, @audition_cycle) %>
<% form_method = audition_session.persisted? ? :patch : :post %>
<%= form_with(url: form_url, method: form_method, scope: :audition_session, class: "contents") do |form| %>
  <% if audition_session.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-lg mb-3">
      <h2><%= pluralize(audition_session.errors.count, "error") %> prohibited this audition_session from being saved:</h2>

      <ul class="list-disc ml-6">
        <% audition_session.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="mb-5">
    <%= form.label :start_at, "Start Session At" %>
    <%= form.datetime_field :start_at, class: ["block shadow-sm rounded-lg border px-3 py-2 mt-2 w-full", {"border-gray-400": audition_session.errors[:start_at].none?, "border-pink-500": audition_session.errors[:start_at].any?}] %>
  </div>

  <div class="my-5">
    <%= form.label :location_id, "Location" %>
    <%= form.collection_select :location_id, Current.organization.locations, :id, :name, { prompt: "Select a location" }, { required: true, class: ["block shadow-sm rounded-lg border px-3 py-2 mt-2 w-full", {"border-gray-400": audition_session.errors[:location_id].none?, "border-pink-500": audition_session.errors[:location_id].any?}], data: { "location-modal-target": "locationSelect", action: "change->location-modal#handleLocationChange" } } %>
    <a href="#" data-action="click->location-modal#openModal" class="text-pink-500 underline text-sm">Add a Location</a>
  </div>

  <div class="border-t border-gray-200 pt-5 mt-5">
    <% button_text = audition_session.persisted? ? "Update Session" : "Schedule Session" %>
    <div class="flex gap-2">
      <%= render "shared/button", text: button_text, variant: "primary", size: "medium", type: :submit, class: "flex-1" %>
      <%= render "shared/button", text: "Cancel", variant: "ghost-cancel", size: "medium", type: :button, data: { action: "click->audition-session-modal#close" }, class: "flex-1" %>
    </div>
  </div>
<% end %>
