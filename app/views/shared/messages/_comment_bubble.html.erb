<%#
  Comment/Reply Bubble Component

  Renders a single reply (legacy - now primarily using thread_display.html.erb)
  Kept for backwards compatibility
%>

<%
  sender_person = message.sender.is_a?(Person) ? message.sender : message.sender&.person
%>

<%# Facebook-style comment bubble with rounded-lg per CLAUDE.md %>
<div class="flex gap-2">
  <% if sender_person %>
    <% headshot_variant = sender_person.safe_headshot_variant(:thumb) %>
    <% if headshot_variant %>
      <%= image_tag headshot_variant, alt: sender_person.name, class: "w-8 h-8 rounded-lg object-cover flex-shrink-0" %>
    <% else %>
      <div class="w-8 h-8 rounded-lg bg-gray-200 flex items-center justify-center text-gray-600 text-xs font-bold flex-shrink-0">
        <%= sender_person.initials %>
      </div>
    <% end %>
  <% else %>
    <div class="w-8 h-8 rounded-lg bg-gray-200 flex-shrink-0"></div>
  <% end %>
  <div class="flex-1">
    <div class="bg-gray-100 rounded-2xl px-3 py-2 inline-block max-w-full">
      <span class="font-semibold text-gray-900 text-sm"><%= message.sender_name %></span>
      <p class="text-sm text-gray-800"><%= strip_tags(message.body.to_plain_text) %></p>
    </div>
    <div class="flex items-center gap-3 mt-1 ml-1 text-xs text-gray-500">
      <span><%= time_ago_in_words(message.created_at) %></span>
      <button class="font-semibold hover:underline">Reply</button>
    </div>
  </div>
</div>
