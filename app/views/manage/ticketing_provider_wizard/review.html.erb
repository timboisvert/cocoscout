<%= render layout: "manage/ticketing_provider_wizard/wizard_layout", locals: { current_step: 4, step_name: "Review" } do %>
  <h2 class="text-xl font-semibold text-gray-900 mb-2">Review & Connect</h2>
  <p class="text-sm text-gray-600 mb-6">Review your connection details before completing setup.</p>

  <div class="space-y-4 mb-6">
    <div class="bg-gray-50 rounded-lg p-4">
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 rounded-lg bg-pink-100 flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-pink-600">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z" />
          </svg>
        </div>
        <div class="flex-1">
          <div class="font-medium text-gray-900"><%= @wizard_state[:name] %></div>
          <div class="text-sm text-gray-500"><%= @provider_info[:name] %></div>
        </div>
        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
          <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
          </svg>
          Verified
        </span>
      </div>
    </div>

    <% if @wizard_state[:account_name].present? %>
      <div class="flex items-center justify-between py-2 border-b border-gray-100">
        <span class="text-sm text-gray-500">Account</span>
        <span class="text-sm font-medium text-gray-900"><%= @wizard_state[:account_name] %></span>
      </div>
    <% end %>

    <% if @wizard_state[:event_count].present? %>
      <div class="flex items-center justify-between py-2 border-b border-gray-100">
        <span class="text-sm text-gray-500">Available Events</span>
        <span class="text-sm font-medium text-gray-900"><%= @wizard_state[:event_count] %></span>
      </div>
    <% end %>

    <div class="flex items-center justify-between py-2 border-b border-gray-100">
      <span class="text-sm text-gray-500">Auto-sync</span>
      <span class="text-sm font-medium text-gray-900">Enabled (hourly)</span>
    </div>
  </div>

  <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
    <div class="flex">
      <svg class="w-5 h-5 text-blue-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <div class="ml-3 text-sm text-blue-700">
        <p class="font-medium">Next step: Link your productions</p>
        <p class="mt-1">After connecting, go to Money &rarr; Financials &rarr; [Production] &rarr; Ticketing to link productions to your <%= @provider_info[:name] %> events.</p>
      </div>
    </div>
  </div>

  <%= form_with url: manage_ticketing_wizard_create_path(@organization), method: :post do %>
    <div class="flex justify-between pt-4 border-t border-gray-200">
      <%= link_to manage_ticketing_wizard_credentials_path(@organization), class: "text-sm text-gray-500 hover:text-gray-700 flex items-center" do %>
        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      <% end %>
      <%= render "shared/button", text: "Connect Platform", variant: "primary", size: "medium", type: :submit %>
    </div>
  <% end %>
<% end %>
