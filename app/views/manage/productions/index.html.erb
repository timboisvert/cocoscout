<% content_for :title, "Select a Production" %>

<div class="w-full">

  <%= render partial: "shared/top_menu", locals: {
    breadcrumbs: [],
    text: "My Productions",
    links: Current.user.manager? ? [
      {text: "Add Production", path: new_manage_production_path}
    ] : []
  } %>

  <% if @productions.any? %>
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 mt-4">
      <% @productions.each do |production| %>
        <%= link_to manage_production_path(production), class: "group" do %>
          <div class="aspect-square border border-gray-200 rounded-lg hover:border-pink-500 hover:shadow-lg transition-all flex flex-col items-center justify-center p-4 bg-white">
            <% logo_variant = production.safe_logo_variant(:small) %>
            <% if logo_variant %>
              <div class="w-full h-full flex items-center justify-center mb-2">
                <%= image_tag logo_variant, alt: "#{production.name} logo", class: "max-w-full max-h-[70%] object-contain" %>
              </div>
            <% else %>
              <div class="w-20 h-20 rounded-lg bg-gray-100 flex items-center justify-center text-gray-600 font-bold text-2xl mb-2">
                <%= production.initials %>
              </div>
            <% end %>
            <div class="text-center font-semibold text-sm group-hover:text-pink-500 transition-colors line-clamp-2">
              <%= production.name %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  <% else %>
    <div class="max-w-lg mx-auto p-6 bg-white rounded shadow mt-10">
      <h1 class="text-xl font-bold mb-4 text-center">Add a Production</h1>

      <%= form_with(model: [:manage, @production], class: "contents") do |form| %>

        <div class="mb-5">
          <% if @production.errors[:name].none? %>
            <%= form.label :name, "Name:" %>
          <% else %>
            <%= form.label :name, "Name is required", class: "text-pink-600"  %>
          <% end %>
          <%= form.text_field :name, class: ["block shadow-sm rounded-lg border px-3 py-2 mt-2 w-full", {"border-gray-400": @production.errors[:name].none?, "border-pink-500": @production.errors[:name].any?}] %>
        </div>

        <div class="inline">
          <%= form.submit "Add Production", class: "sm:w-auto rounded-lg px-3.5 py-2.5 text-white bg-pink-500 hover:bg-pink-600 inline-block font-medium cursor-pointer" %>
          <%= link_to "Back", "javascript:history.back()", class: "w-full sm:w-auto text-center mt-2 sm:mt-0 sm:ml-2 rounded-lg px-3.5 py-2.5 bg-gray-100 hover:bg-gray-50 inline-block font-medium" %>
        </div>
      <% end %>
    </div>
  <% end %>

</div>