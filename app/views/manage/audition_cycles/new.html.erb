<% content_for :title, "New audition cycle" %>

<div class="w-full">
  <%= render partial: "shared/notice", locals: { notice: notice } %>
  <%= render partial: "shared/top_menu", locals: {
    breadcrumbs: [
      ["Productions", manage_productions_path],
      [@production.name, manage_production_path(@production)]
    ],
    text: "Offer Auditions",
    links: []
  } %>

  <%= form_with(model: [:manage, @production, @audition_cycle], class: "contents") do |form| %>
    <div class="mt-5 mb-7">
      <p class="text-sm text-gray-500 mb-4">Choose which audition formats to accept. You can enable both options to allow performers to submit videos and also attend in-person auditions.</p>

      <!-- Video Submissions Toggle -->
      <div class="flex items-center justify-between py-3 border-b border-gray-100">
        <div>
          <h4 class="font-medium text-gray-900">Video Submissions</h4>
          <p class="text-sm text-gray-500">Allow performers to submit video auditions</p>
        </div>
        <label class="relative inline-flex items-center cursor-pointer">
          <%= form.check_box :allow_video_submissions,
              class: "sr-only peer",
              checked: @audition_cycle.allow_video_submissions %>
          <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-pink-100 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-pink-500"></div>
        </label>
      </div>

      <!-- In-Person Auditions Toggle -->
      <div class="flex items-center justify-between py-3">
        <div>
          <h4 class="font-medium text-gray-900">In-Person Auditions</h4>
          <p class="text-sm text-gray-500">Schedule and manage in-person audition sessions</p>
        </div>
        <label class="relative inline-flex items-center cursor-pointer">
          <%= form.check_box :allow_in_person_auditions,
              class: "sr-only peer",
              checked: @audition_cycle.allow_in_person_auditions.nil? ? true : @audition_cycle.allow_in_person_auditions %>
          <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-pink-100 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-pink-500"></div>
        </label>
      </div>
    </div>

    <%= render partial: "shared/top_menu", locals: {
      breadcrumbs: [],
      text: "Sign-up Window",
      links: []
    } %>

    <p class="text-sm text-gray-500 mb-5">When should the Sign-up window open? You can optionally set a close date, or leave it open-ended to keep accepting sign-ups indefinitely.</p>

    <div class="sm:flex my-5">
      <div class="w-full sm:w-1/2 sm:mr-5">
        <%= form.label :opens_at, "Open At:" %>
        <%= form.datetime_field :opens_at, class: ["block shadow-sm rounded-lg border px-3 py-2 mt-2 w-full", {"border-gray-400": @audition_cycle.errors[:opens_at].none?, "border-pink-500": @audition_cycle.errors[:opens_at].any?}] %>
      </div>
      <div class="w-full mt-5 sm:w-1/2 sm:ml-5 sm:mt-0" data-controller="date-field-toggle">
        <%= form.label :closes_at, "Close At (Optional):" %>
        <%= form.hidden_field :closes_at, data: { date_field_toggle_target: "hiddenField" } %>
        <%= form.datetime_field :closes_at, class: ["block shadow-sm rounded-lg border px-3 py-2 mt-2 w-full", {"border-gray-400": @audition_cycle.errors[:closes_at].none?, "border-pink-500": @audition_cycle.errors[:closes_at].any?}], data: { date_field_toggle_target: "field" }, name: "" %>
        <a href="#" class="text-sm text-pink-500 underline mt-1 ml-1 inline-block" data-action="click->date-field-toggle#toggle" data-date-field-toggle-target="link"></a>
      </div>
    </div>

    <div class="border-t border-gray-200 pt-5 mt-5">
      <%= render "shared/button", text: "Open", variant: "primary", size: "medium", type: :submit %>
      <%= render "shared/button", text: "Back", variant: "ghost-cancel", size: "medium", path: "javascript:history.back()", type: :button %>
    </div>
  <% end %>

</div>
