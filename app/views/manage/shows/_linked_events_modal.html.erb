<%# Modal for managing linked events %>
<%# Contains: current show display, linked events with remove on hover, add new linkages, delete linkage %>

<div data-show-linkage-target="modal"
     class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col">
    <%# Modal Header %>
    <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200">
      <h2 class="text-lg font-semibold text-gray-900 coustard-regular">
        <%= show.linked? ? "Manage Linked Events" : "Link Events" %>
      </h2>
      <button type="button"
              data-action="click->show-linkage#closeModal"
              class="text-gray-400 hover:text-gray-500">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <%# Modal Body - scrollable %>
    <div class="flex-1 overflow-y-auto px-6 py-4">
      <%= render "manage/shows/linked_events_modal_body", show: show, production: production %>
    </div>

    <%# Modal Footer %>
    <div class="px-6 py-3 border-t border-gray-200 bg-gray-50 flex justify-between" data-show-linkage-target="footer">
      <% if show.linked? %>
        <%= render "shared/button",
                text: "Delete this linkage",
                variant: "outline",
                size: "small",
                type: :button,
                classes: "text-red-600 border-red-300 hover:bg-red-50",
                data: { action: "click->show-linkage#deleteLinkage" } %>
      <% else %>
        <div></div>
      <% end %>

      <%= render "shared/button",
              text: "Done",
              variant: "secondary",
              size: "small",
              type: :button,
              data: { action: "click->show-linkage#closeModal" } %>
    </div>
  </div>
</div>

<%# Confirmation dialog for delete %>
<div data-show-linkage-target="deleteConfirmModal"
     class="hidden fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-2">Delete this linkage?</h3>
    <p class="text-sm text-gray-600 mb-6">
      This will unlink all <%= show.linked? ? show.event_linkage.shows.count : 0 %> events. The events themselves will not be deleted.
    </p>
    <div class="flex justify-end gap-3">
      <%= render "shared/button",
              text: "Cancel",
              variant: "secondary",
              size: "small",
              type: :button,
              data: { action: "click->show-linkage#cancelDeleteLinkage" } %>
      <%= render "shared/button",
              text: "Delete Linkage",
              variant: "primary",
              size: "small",
              type: :button,
              classes: "bg-red-600 hover:bg-red-700",
              data: { action: "click->show-linkage#confirmDeleteLinkage" } %>
    </div>
  </div>
</div>
