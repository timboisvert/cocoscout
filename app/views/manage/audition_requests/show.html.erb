<% content_for :title, "Audition Requests" %>
<div class="w-full">
  <%= render partial: "shared/notice", locals: { notice: notice } %>
  <%= render partial: "shared/top_menu", locals: {
    breadcrumbs: [
      ["Auditions", manage_production_auditions_path(@production)],
      ["Audition Requests", manage_production_call_to_audition_audition_requests_path(@production, @call_to_audition)]
    ],
    text: @audition_request.person.name.truncate(40, omission: "..."),
    links: []
  } %>

  <div id="<%= dom_id @audition_request %>" class="w-full sm:w-auto my-5 space-y-5 mb-30">
    <div class="flex flex-col sm:flex-row w-full gap-6">
      <div class="w-full sm:w-[60%] h-screen bg-gray-100 flex flex-col">
        <% if @person.resume.attached? && @person.resume.previewable? %>
          <div class="w-full">
        <%= image_tag @person.resume.preview(resize_to_limit: [1224, 1584]), class: "w-full object-contain" %>
          </div>
        <% else %>
          <p class="text-center mt-10">No resume found</p>
        <% end %>
      </div>
      <div class="w-full sm:w-[40%] flex flex-col">

        <%= render "shared/person_card", person: @person %>

        <% if @answers.any? %>
          <% @answers.each do |answer| %>
            <div class="p-2 border border-gray-200 rounded-lg hover:border-gray-400 transition-all mt-2">
              <div class="text-md"><%= answer.question.text %></div>
              <div class="text-md font-medium">
                <% if answer.question.question_type == "yesno" %>
                  <%= answer.value.capitalize %>
                <% elsif answer.question.question_type == "multiple-multiple" %>
                  <% answer.value_as_array.each do |value| %>
                    <div class="inline-block mb-1 px-2 bg-pink-100 rounded-lg"><%= value %></div>
                  <% end %>
                <% elsif answer.question.question_type == "multiple-single" %>
                  <div class="inline-block mb-1 px-2 bg-pink-100 rounded-lg"><%= answer.value %></div>
                <% else %>
                  <%= answer.value %>
                <% end %>
              </div>
            </div>
          <% end %>
        <% end %>

        <div>
          <%= link_to "Edit this Audition Request",
            edit_manage_production_call_to_audition_audition_request_path(@production, @call_to_audition, @audition_request),
            class: "mt-6 bg-pink-500 hover:bg-pink-600 text-white py-2 px-4 rounded transition-colors cursor-pointer inline-block" %>

          <%= link_to "Delete this Audition Request",
            manage_production_call_to_audition_audition_request_path(@production, @call_to_audition, @audition_request),
            data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this audition request?" },
            class: "mt-6 bg-pink-500 hover:bg-pink-600 text-white py-2 px-4 rounded transition-colors cursor-pointer inline-block" %>
        </div>

    </div>
  </div>
</div>

<div class="fixed bottom-0 left-0 h-21 w-full bg-white text-pink-500 p-2 border-t-4 border-pink-400 pl-56">

    <div class="grid grid-cols-4 gap-0">

      <div class="ml-auto align-right pr-5 pt-1">
        <% if @audition_request.previous %>
          <%= link_to manage_production_call_to_audition_audition_request_path(@production, @call_to_audition, @audition_request.previous) do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="h-10 w-10">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
            </svg>
            <p class="text-left text-xs">
              Previous
            </p>
          <% end %>
        <% end %>
      </div>

      <div class="grid grid-cols-3 gap-2 col-span-2 items-center content-center">
        <%
          [:undecided, :accepted, :passed].each do |status|
            classes = "text-lg font-bold px-5 py-2.5 text-center border rounded-lg border-gray-200 bg-white text-pink-500"

            # Set the background color based on status
            if @audition_request.status == status.to_s
              classes += " bg-pink-500 hover:bg-pink-600 text-white"
            end
        %>
          <%= link_to status.capitalize, manage_production_call_to_audition_audition_request_set_status_path(@production, @call_to_audition, @audition_request, status: status), class: classes, data: { turbo_method: :post } %>
        <% end %>
      </div>

      <div class="pl-5 pt-1 mr-auto align-left">
        <% if @audition_request.next %>
          <%= link_to manage_production_call_to_audition_audition_request_path(@production, @call_to_audition, @audition_request.next) do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="h-10 w-10">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
            </svg>
            <p class="text-center text-xs">
              Next
            </p>
          <% end %>
        <% end %>
      </div>

    </div>

</div>