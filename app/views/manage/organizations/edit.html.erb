<% content_for :title, "Edit Organization" %>

<div class="min-h-screen bg-gray-50">
  <%= render partial: "shared/notice", locals: { notice: notice } %>

  <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Header -->
    <div class="mb-8">
      <div class="flex items-center gap-2 text-sm text-gray-600 mb-4">
        <%= link_to "Organizations", manage_organizations_path, class: "hover:text-pink-600" %>
        <span>/</span>
        <%= link_to @organization.name, manage_organization_path(@organization), class: "hover:text-pink-600" %>
        <span>/</span>
        <span class="text-gray-900">Edit</span>
      </div>
      <h1 class="text-3xl font-bold text-gray-900 coustard-regular">Edit Organization</h1>
    </div>

    <%= form_with(model: [:manage, @organization], class: "bg-white border border-gray-200 rounded-lg p-6") do |form| %>
      <div class="space-y-6">
        <!-- Logo Section -->
        <div>
          <label class="block text-sm font-semibold text-gray-900 mb-3">Organization Logo</label>

          <div class="flex items-start gap-6">
            <!-- Current Logo Preview -->
            <div class="flex-shrink-0">
              <div class="w-32 h-32 border-2 border-gray-200 rounded-lg overflow-hidden bg-gray-50 flex items-center justify-center">
                <% if @organization.logo.attached? %>
                  <%= image_tag @organization.logo, class: "w-full h-full object-cover" %>
                <% else %>
                  <svg class="w-16 h-16 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                  </svg>
                <% end %>
              </div>
            </div>

            <!-- Upload Controls -->
            <div class="flex-1">
              <%= form.file_field :logo,
                  accept: "image/*",
                  direct_upload: true,
                  class: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-pink-50 file:text-pink-600 hover:file:bg-pink-100 cursor-pointer" %>
              <p class="mt-2 text-xs text-gray-500">
                PNG, JPG, or GIF. Recommended size: 512x512px
              </p>
              <% if @organization.logo.attached? %>
                <%= button_to "Remove Logo",
                    remove_logo_manage_organization_path(@organization),
                    method: :delete,
                    data: { turbo_confirm: "Are you sure you want to remove the logo?" },
                    class: "mt-3 text-xs text-red-600 hover:text-red-700 font-medium" %>
              <% end %>
            </div>
          </div>
        </div>

        <!-- Name Field -->
        <div>
          <%= form.label :name, "Organization Name", class: "block text-sm font-semibold text-gray-900 mb-2" %>
          <%= form.text_field :name,
              class: "block w-full rounded-lg border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500 #{ @organization.errors[:name].any? ? 'border-red-500' : '' }",
              placeholder: "e.g., Broadway Productions Inc." %>
          <% if @organization.errors[:name].any? %>
            <p class="mt-1 text-sm text-red-600"><%= @organization.errors[:name].first %></p>
          <% end %>
        </div>

        <!-- Action Buttons -->
        <div class="flex items-center gap-3 pt-4 border-t border-gray-200">
          <%= render "shared/button", text: "Save Changes", variant: "primary", size: "medium", type: :submit %>
          <%= render "shared/button", text: "Cancel", variant: "ghost-cancel", size: "medium", path: manage_organization_path(@organization), type: :button %>
        </div>
      </div>
    <% end %>
  </div>
</div>
