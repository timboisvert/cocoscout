
<turbo-frame id="cast-membership-<%= person.id %>">
<div class="p-5 border border-gray-200 rounded-lg hover:border-gray-400 transition-all">

    <% unique_id = "cast-membership-#{SecureRandom.hex(6)}" %>
    <h1 class="font-bold text-lg cursor-pointer" onclick="document.getElementById('<%= unique_id %>').classList.toggle('hidden')">
        Cast Membership
    </h1>

    <div id="<%= unique_id %>" class="hidden">


        <% casts = person.casts.where(production: production) %>
        <% all_casts = production.casts.to_a %>
        <% available_casts = all_casts - casts.to_a %>
        <% if casts.any? %>
            <% casts.each do |cast| %>
                <div class="my-2 p-2 border rounded bg-gray-50">
                    <strong><%= cast.name %></strong>
                </div>
            <% end %>
        <% else %>
            <div class="my-2 p-2 border rounded bg-yellow-50 text-yellow-800">
                Not currently cast in this production.
            </div>
        <% end %>

        <% if available_casts.any? %>
            <%= form_with url: add_person_production_cast_path(production, 0), method: :post, data: { turbo_frame: "cast-membership-#{person.id}" }, html: { class: "mt-4 flex gap-2 items-center" } do |f| %>
                <%= select_tag :cast_id, options_from_collection_for_select(available_casts, :id, :name), prompt: "Add to cast...", class: "border rounded px-2 py-1" %>
                <%= hidden_field_tag :person_id, person.id %>
                <%= submit_tag "Add", class: "px-3 py-1 rounded bg-pink-500 text-white font-bold hover:bg-pink-600" %>
            <% end %>
        <% end %>

    </div>

</div>
</turbo-frame>