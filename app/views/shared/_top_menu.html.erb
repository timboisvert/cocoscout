<div class="flex items-top justify-between mb-4 border-b-1 border-gray-200 pb-2">

  <div class="pt-1 coustard-regular">

    <% breadcrumbs.each do |name, path| %>
      <% display_name = name.length > 40 ? "#{name[0..37]}..." : name %>
      <% if path %>
        <%= link_to display_name, path, class:"text-md sm:text-xl mb-1 mr-2 text-pink-500 hover:text-pink-600 underline" %>
        <span class="text-md sm:text-xl font-medium text-gray-500 mr-2"> /</span>
      <% else %>
        <span class="text-md sm:text-xl mb-1 mr-2"><%= display_name %></span>
        <span class="text-md sm:text-xl mb-1 mr-2">/</span>
      <% end %>
    <% end %>
    <% display_text = text.length > 40 ? "#{text[0..37]}..." : text %>
    <span class="text-md sm:text-xl mb-1 mr-2"><%= display_text %></span>

  </div>

  <% if links.count > 0 %>
    <div class="flex gap-2 flex-wrap">
      <% links.each do |link| %>
        <%
          # For Manage controllers, check permissions
          if controller.class.ancestors.include?(Manage::ManageController)
            requires_global_manager = link[:global_manager_required] || false
            can_show_link = requires_global_manager ? current_user_is_global_manager? : current_user_can_manage?
          else
            # For non-Manage controllers (like My::ProfileController), always show links
            can_show_link = true
          end
        %>
        <% if can_show_link %>
          <%= render partial: "shared/button", locals: {
            text: link[:text],
            path: link[:path],
            icon: link[:icon],
            variant: link[:color] == "white" ? "outline" : "primary",
            size: "small",
            data: link[:data_action].present? ? { action: link[:data_action] } : {},
            classes: "text-xs sm:text-sm px-3 sm:px-5 py-1.5 sm:py-2.5 sm:h-10 whitespace-nowrap"
          } %>
        <% end %>
      <% end %>
    </div>
  <% end %>

</div>