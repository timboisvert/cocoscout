<%= render layout: "manage/ticketing_setup_wizard/wizard_layout", locals: { current_step: 3, step_name: "Strategy" } do %>
  <div class="text-center mb-6">
    <div class="w-16 h-16 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-4">
      <svg class="w-8 h-8 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
      </svg>
    </div>
    <h2 class="text-xl font-bold text-gray-900 coustard-regular">How should we list your shows?</h2>
    <p class="text-gray-600 mt-2">Choose which shows to include and how they should appear on ticketing sites.</p>
  </div>

  <%= form_with url: manage_ticketing_setup_wizard_save_strategy_path, method: :post, local: true do |form| %>
    <div class="space-y-6">
      <!-- Listing Mode -->
      <div>
        <label class="block text-sm font-medium text-gray-900 mb-3">Which shows should be listed?</label>
        <div class="space-y-3">
          <label class="flex items-start gap-3 p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-pink-300 transition-colors">
            <input type="radio" name="listing_mode" value="all_shows"
                   <%= "checked" if @wizard_state[:listing_mode] == "all_shows" %>
                   class="h-4 w-4 mt-1 text-pink-600 border-gray-300 focus:ring-pink-500 accent-pink-500">
            <div>
              <span class="font-medium text-gray-900">All shows</span>
              <p class="text-sm text-gray-500 mt-0.5">Every show in this production will be listed for ticket sales. New shows are automatically added.</p>
            </div>
          </label>

          <label class="flex items-start gap-3 p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-pink-300 transition-colors">
            <input type="radio" name="listing_mode" value="future_only"
                   <%= "checked" if @wizard_state[:listing_mode] == "future_only" %>
                   class="h-4 w-4 mt-1 text-pink-600 border-gray-300 focus:ring-pink-500 accent-pink-500">
            <div>
              <span class="font-medium text-gray-900">Future shows only</span>
              <p class="text-sm text-gray-500 mt-0.5">Only shows scheduled from today forward. Past shows won't be listed.</p>
            </div>
          </label>

          <label class="flex items-start gap-3 p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-pink-300 transition-colors">
            <input type="radio" name="listing_mode" value="selected_shows"
                   <%= "checked" if @wizard_state[:listing_mode] == "selected_shows" %>
                   class="h-4 w-4 mt-1 text-pink-600 border-gray-300 focus:ring-pink-500 accent-pink-500">
            <div>
              <span class="font-medium text-gray-900">Select specific shows</span>
              <p class="text-sm text-gray-500 mt-0.5">Manually choose which shows to list. You'll configure this after setup.</p>
            </div>
          </label>
        </div>
      </div>

      <!-- Grouping Strategy -->
      <div>
        <label class="block text-sm font-medium text-gray-900 mb-3">How should shows appear on ticketing sites?</label>
        <div class="space-y-3">
          <label class="flex items-start gap-3 p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-pink-300 transition-colors">
            <input type="radio" name="grouping_strategy" value="individual_events"
                   <%= "checked" if @wizard_state[:grouping_strategy] == "individual_events" %>
                   class="h-4 w-4 mt-1 text-pink-600 border-gray-300 focus:ring-pink-500 accent-pink-500">
            <div>
              <span class="font-medium text-gray-900">Individual events</span>
              <p class="text-sm text-gray-500 mt-0.5">Each show is its own separate event listing. Best for variety shows or different content per date.</p>
            </div>
          </label>

          <label class="flex items-start gap-3 p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-pink-300 transition-colors <%= @supports_recurring ? '' : 'opacity-50' %>">
            <input type="radio" name="grouping_strategy" value="recurring_event"
                   <%= "checked" if @wizard_state[:grouping_strategy] == "recurring_event" %>
                   <%= "disabled" unless @supports_recurring %>
                   class="h-4 w-4 mt-1 text-pink-600 border-gray-300 focus:ring-pink-500 accent-pink-500">
            <div>
              <span class="font-medium text-gray-900">Recurring event</span>
              <p class="text-sm text-gray-500 mt-0.5">One event with multiple date options. Buyers select their preferred date. Best for the same show on different days.</p>
              <% unless @supports_recurring %>
                <p class="text-xs text-yellow-600 mt-1">Not available with your selected providers</p>
              <% end %>
            </div>
          </label>
        </div>
      </div>

      <div class="p-4 bg-pink-50 rounded-lg">
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-pink-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
          </svg>
          <div class="text-sm text-pink-800">
            <p class="font-medium">Opt-out model</p>
            <p>You can always exclude specific shows later. This just sets the default.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="mt-8 flex justify-between">
      <%= link_to manage_ticketing_setup_wizard_providers_path do %>
        <%= render "shared/button", text: "Back", variant: "secondary", size: "medium" %>
      <% end %>
      <%= render "shared/button", text: "Next", variant: "primary", size: "medium", type: :submit %>
    </div>
  <% end %>
<% end %>
