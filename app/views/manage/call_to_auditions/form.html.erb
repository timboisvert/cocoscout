<% content_for :title, "Editing call to audition" %>

<div class="w-full">
  <%= render partial: "shared/notice", locals: { notice: notice } %>
  <%= render partial: "shared/top_menu", locals: {
    breadcrumbs: [
      ["Auditions", manage_production_auditions_path(@production)]
    ],
    text: "Sign-up Form",
    links: []
  } %>

  <div class="w-full" data-controller="tabs">
    <nav class="flex space-x-2 border-b border-gray-200 mb-4">
       <% idx = 0 %>
      <button type="button" data-tabs-target="tab" data-index="<%= idx %>" data-action="tabs#select" class="px-4 py-2 text-sm font-medium bg-white border-b-2 text-pink-600 cursor-pointer">Header Text</button>
      <% idx += 1 %>
      <% if @call_to_audition.audition_type == "video_upload" %>
        <button type="button" data-tabs-target="tab" data-index="<%= idx %>" data-action="tabs#select" class="px-4 py-2 text-sm font-medium bg-gray-50 border-b-2 text-gray-500 cursor-pointer">Video Field</button>
        <% idx += 1 %>
      <% end %>
      <button type="button" data-tabs-target="tab" data-index="<%= idx %>" data-action="tabs#select" class="px-4 py-2 text-sm font-medium bg-gray-50 border-b-2 text-gray-500 cursor-pointer">Success Text</button>
      <% idx += 1 %>
      <button type="button" data-tabs-target="tab" data-index="<%= idx %>" data-action="tabs#select" class="px-4 py-2 text-sm font-medium bg-gray-50 border-b-2 text-gray-500 cursor-pointer">Custom Questions</button>
    </nav>

    <%= form_with(model: [:manage, @production, @call_to_audition], class: "contents") do |form| %>
      <%= hidden_field_tag :active_tab, params[:tab] || 0, data: { tabs_target: "hiddenField" } %>
      <div data-tabs-target="panel">
        <div class="my-5">
          <p class="text-sm text-gray-500 pb-5">At the top of the Sign-up form you can add text to describe the production, the audition process, cast expectations, etc.</p>
          <%= form.rich_text_area :header_text, class: ["block shadow-sm rounded-lg border px-3 py-2 mt-2 w-full max-h-96 overflow-auto", {"border-gray-400": @call_to_audition.errors[:header_text].none?, "border-pink-500": @call_to_audition.errors[:header_text].any?}] %>
        </div>
      </div>

      <% if @call_to_audition.audition_type == "video_upload" %>
        <div data-tabs-target="panel" class="hidden">
          <div class="my-5">
            <p class="text-sm text-gray-500 pb-5">Add text that gets shown with the video upload URL, which can be used to provide instructions on what the video should be, how it should be uploaded, etc.</p>
            <%= form.rich_text_area :video_field_text, class: ["block shadow-sm rounded-lg border px-3 py-2 mt-2 w-full max-h-96 overflow-auto", {"border-gray-400": @call_to_audition.errors[:video_field_text].none?, "border-pink-500": @call_to_audition.errors[:video_field_text].any?}] %>
          </div>
        </div>
      <% end %>

      <div data-tabs-target="panel" class="hidden">
        <div class="my-5">
          <p class="text-sm text-gray-500 pb-5">After an auditionee submits the Sign-up form, they're shown text that you can customize here.</p>
          <%= form.rich_text_area :success_text, class: ["block shadow-sm rounded-lg border px-3 py-2 mt-2 w-full max-h-96 overflow-auto", {"border-gray-400": @call_to_audition.errors[:success_text].none?, "border-pink-500": @call_to_audition.errors[:success_text].any?}] %>
        </div>
      </div>

      <div class="w-full border-t border-gray-200 pt-5 my-5" id="call-to-audition-form-buttons">
        <%= form.submit "Update", class: "w-full sm:w-auto rounded-lg px-3.5 py-2.5 bg-pink-500 hover:bg-pink-600 text-white inline-block font-medium cursor-pointer" %>
        <%= link_to "Back", "javascript:history.back()", class: "w-full sm:w-auto text-center mt-2 sm:mt-0 sm:ml-2 rounded-lg px-3.5 py-2.5 bg-gray-100 hover:bg-gray-50 inline-block font-medium" %>
      </div>
    <% end %>

    <div data-tabs-target="panel" class="hidden">
      <div class="my-5">
        <p class="text-sm text-gray-500 pb-5">You can add additional questions to your Sign-up form.</p>
        <%= render partial: "questions" %>
      </div>
    </div>
  </div>

</div>
