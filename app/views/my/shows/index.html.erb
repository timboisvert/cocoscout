<% content_for :title, "My Shows" %>

<div class="w-full">

  <%= render partial: "shared/notice", locals: { notice: notice } %>

  <%= render partial: "shared/top_menu", locals: {
    breadcrumbs: [],
    text: "My Shows",
    links: []
  } %>


    <% if @productions.any? %>

        <div class="grid grid-cols-4 gap-2 mt-2">
            <% @productions.each do |production| %>
                <div class="p-4 border border-gray-200 rounded-lg hover:border-gray-400 transition-all flex items-top">
                    <div class="flex flex-col w-full">
                        <% if production.logo.attached? %>
                            <div class="w-full mb-2 min-h-[112px]">
                                <%= image_tag production.logo.variant(:small), alt: "#{production.name} logo", class: "w-full object-contain rounded" %>
                            </div>
                        <% end %>
                        <div class="font-bold text-xl"><%= production.name %></div>
                        <div class="mt-2 w-full text-sm">
                            <p class="text-gray-500">Next Show:</p>

                            <% if production.next_show.present? %>
                                <p class="mt-1"><%= production.next_show.date_and_time.strftime('%b %d, %Y at %l:%M %p') %> </p>
                            <% else %>
                                <p class="text-sm text-gray-500 mt-1">
                                    No shows scheduled
                                </p>
                            <% end %>
                        </div>
                        <div class="mt-2 w-full text-sm">
                            <p class="text-gray-500">Next Show I have a role in:</p>
                            <% next_show = Current.user.person.next_show_for_production(production)%>
                            <% if next_show %>
                                <p class="mt-1"><%= next_show.date_and_time.strftime('%b %d, %Y at %l:%M %p') %></p>
                            <% else %>
                                <p class="text-sm text-gray-500 mt-1">
                                    No roles assigned
                                </p>
                            <% end %>
                        </div>
                    </div>

                </div>
            <% end %>
        </div>
    <% else %>
         <p class="text-gray-500 text-sm pt-2">
            You aren't a cast member of any shows.
        </p>
    <% end %>

</div>