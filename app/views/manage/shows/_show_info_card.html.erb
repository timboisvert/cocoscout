<%
  # Parameters:
  # - show: the Show object
  # - compact: optional boolean to make the poster smaller (default: false)
%>

<div class="border border-gray-200 rounded-lg overflow-hidden bg-white mb-6">
  <div class="flex flex-col sm:flex-row">
    <!-- Poster Section -->
    <% if show.event_type == "show" %>
      <div class="flex-shrink-0 bg-gray-50 flex items-center justify-center p-4">
        <% poster_url = safe_poster_url(show) %>
        <% if poster_url && !show.canceled %>
          <%= image_tag poster_url, alt: "Show Poster", class: "rounded shadow-sm h-full #{compact ? 'max-h-[120px]' : 'max-h-none'} w-auto border border-gray-200" %>
        <% else %>
          <div class="<%= compact ? 'w-[90px] h-[120px]' : 'w-[180px]' %> aspect-[2/3] rounded bg-gray-200 flex items-center justify-center border border-gray-300">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="<%= compact ? 'w-8 h-8' : 'w-16 h-16' %> text-gray-400">
              <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
            </svg>
          </div>
        <% end %>
      </div>
    <% end %>

    <!-- Details Section -->
    <div class="flex-1 p-6">
      <div class="space-y-4">
        <!-- Title and Badges -->
        <div>
          <h2 class="text-2xl font-bold text-gray-900 mb-2">
            <%= show.date_and_time.strftime("%A, %B %-d, %Y") %>
          </h2>
          <div class="flex items-center gap-2 flex-wrap">
            <% if show.canceled %>
              <span class="inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/10">Canceled</span>
            <% end %>
            <% unless compact %>
              <% if show.recurring? %>
                <span data-controller="tooltip" data-tooltip-text="This is a recurring event" class="inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-inset ring-purple-600/10">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3 mr-1">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" />
                  </svg>
                  Recurring
                </span>
              <% end %>
            <% end %>
            <% event_type_badge_classes = case show.event_type
              when "rehearsal" then "bg-blue-50 text-blue-700 ring-blue-600/10"
              when "meeting" then "bg-green-50 text-green-700 ring-green-600/10"
              else "bg-pink-50 text-pink-700 ring-pink-600/10"
            end %>
            <span class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset <%= event_type_badge_classes %>">
              <%= show.event_type.titleize %>
            </span>
          </div>
        </div>

        <!-- Show Details -->
        <div class="space-y-2 text-sm">
          <div class="flex items-start gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
            </svg>
            <span class="text-gray-900 font-medium"><%= show.date_and_time.strftime("%l:%M %p") %></span>
          </div>

          <% if show.secondary_name.present? %>
            <div class="flex items-start gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 3.75V16.5L12 14.25 7.5 16.5V3.75m9 0H18A2.25 2.25 0 0 1 20.25 6v12A2.25 2.25 0 0 1 18 20.25H6A2.25 2.25 0 0 1 3.75 18V6A2.25 2.25 0 0 1 6 3.75h1.5m9 0h-9" />
              </svg>
              <span class="text-gray-900 font-medium"><%= show.secondary_name %></span>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
